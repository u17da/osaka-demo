<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…ˆç”ŸAI - ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #0066CC;
            --primary-dark: #0052A3;
            --success: #10B981;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F8F9FA;
            --bg-chat: #F0F4F8;
            --text-primary: #1F2937;
            --text-secondary: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans JP", sans-serif;
            background: var(--bg-secondary);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            width: 260px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
            height: 100vh;
            overflow: hidden;
        }
        
        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
        
        .new-chat-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-top: 12px;
            transition: all 0.2s;
        }
        
        .new-chat-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        /* æ™‚é–“å‰²ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .schedule-section-wrapper {
            position: relative;
            border-bottom: 1px solid var(--border);
        }
        
        .schedule-section {
            padding: 16px;
            transition: background-color 0.3s;
            overflow-y: auto;
            flex-shrink: 0;
            min-height: 150px;
            max-height: 300px;
        }
        
        .resize-handle {
            height: 4px;
            background: transparent;
            cursor: ns-resize;
            position: relative;
            transition: background 0.2s;
        }
        
        .resize-handle:hover {
            background: var(--primary);
        }
        
        .resize-handle::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
        }
        
        .resize-handle:hover::after {
            background: var(--primary);
        }
        
        .section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }
        
        .schedule-date-group {
            margin-bottom: 16px;
        }
        
        .schedule-date-group:last-child {
            margin-bottom: 0;
        }
        
        .schedule-date-header {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .schedule-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding-left: 4px;
        }
        
        .schedule-item {
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            position: relative;
        }
        
        .schedule-item::after {
            content: 'â†’';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: all 0.2s;
            color: var(--primary);
            font-weight: bold;
        }
        
        .schedule-item:hover {
            background: #E8F2FF;
            border-color: var(--primary);
            padding-right: 32px;
        }
        
        .schedule-item:hover::after {
            opacity: 1;
        }
        
        .schedule-item.active {
            background: #E8F2FF;
            border-color: var(--primary);
        }
        
        .schedule-time {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }
        
        .schedule-class {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .schedule-subject {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* ãƒãƒ£ãƒƒãƒˆå±¥æ­´ */
        .chat-history-wrapper {
            display: flex;
            flex-direction: column;
            flex: 1;
            overflow: hidden;
            position: relative;
        }
        
        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            min-height: 200px;
        }
        
        /* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¤–ã®ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒãƒ£ãƒƒãƒˆ */
        .standalone-chats {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .history-item {
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 4px;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        
        .history-item:hover {
            background: var(--bg-secondary);
            border-color: var(--border);
        }
        
        .history-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .history-date {
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        /* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚°ãƒ«ãƒ¼ãƒ— */
        .project-group {
            margin-bottom: 12px;
        }
        
        .project-header {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 600;
            font-size: 13px;
            color: var(--text-primary);
        }
        
        .project-header:hover {
            background: var(--bg-secondary);
        }
        
        .project-icon {
            font-size: 16px;
        }
        
        .project-name {
            flex: 1;
        }
        
        .chevron {
            font-size: 10px;
            color: var(--text-secondary);
            transition: transform 0.2s;
        }
        
        .project-header.collapsed .chevron {
            transform: rotate(-90deg);
        }
        
        .project-threads {
            padding-left: 8px;
            margin-top: 4px;
            border-left: 2px solid var(--border);
            margin-left: 20px;
        }
        
        .project-threads.hidden {
            display: none;
        }
        
        /* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .project-action-btn {
            padding: 10px 12px;
            background: transparent;
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 4px;
            transition: all 0.2s;
            font-size: 13px;
            font-weight: 600;
            text-align: left;
            border: 1px solid transparent;
        }
        
        .project-action-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--border);
        }
        
        .project-action-btn.secondary {
            margin-bottom: 0;
            margin-top: 4px;
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 11px;
            text-align: right;
            padding: 6px 12px;
        }
        
        .project-action-btn.secondary:hover {
            color: var(--text-primary);
            background: transparent;
        }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ */
        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .context-badge {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .badge {
            padding: 4px 12px;
            background: var(--bg-secondary);
            border-radius: 100px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            border: 1px solid var(--border);
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .badge.project-badge {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            font-weight: 600;
        }
        
        .badge.context-badge-item {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-color: var(--border);
        }
        
        .badge-icon {
            font-size: 13px;
            line-height: 1;
        }
        
        .data-indicator {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .data-indicator:hover {
            background: var(--bg-secondary) !important;
            border-color: var(--primary) !important;
        }
        
        .data-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }
        
        .data-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
        }
        
        .welcome-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }
        
        .welcome-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .welcome-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .welcome-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 32px;
        }
        
        .welcome-hint {
            font-size: 13px;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            padding: 12px 16px;
            border-radius: 8px;
            border-left: 3px solid var(--primary);
            margin-top: 16px;
            text-align: left;
        }
        
        .preset-info {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 16px;
            padding: 8px 14px;
            background: #F0F9FF;
            border: 1px solid #BFDBFE;
            border-radius: 20px;
        }
        
        .preset-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .preset-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }
        
        .preset-tag {
            padding: 2px 8px;
            background: white;
            border-radius: 10px;
            font-size: 11px;
            color: var(--primary);
            font-weight: 500;
        }
        
        .preset-tag.dynamic {
            background: #E0F2FE;
        }
        
        .suggestion-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            width: 100%;
        }
        
        .suggestion-card {
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .suggestion-card:hover {
            background: #E8F2FF;
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .suggestion-icon {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .suggestion-text {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .message {
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .message.user .message-avatar {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .message.assistant .message-avatar {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        }
        
        .message-content {
            flex: 1;
        }
        
        .message-text {
            background: var(--bg-chat);
            padding: 14px 16px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-primary);
        }
        
        .message.assistant .message-text {
            background: white;
            border: 1px solid var(--border);
        }
        
        .message-meta {
            display: flex;
            gap: 12px;
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .source-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            background: #FEF3C7;
            color: #92400E;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }
        
        /* ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‚«ãƒ¼ãƒ‰ */
        .knowledge-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
            transition: all 0.2s;
        }
        
        .knowledge-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }
        
        .knowledge-card-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .knowledge-card-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .knowledge-card-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .knowledge-card-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }
        
        .knowledge-card-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        /* SharePointãƒ¢ãƒ¼ãƒ€ãƒ« */
        .sharepoint-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 24px;
            animation: fadeIn 0.3s;
        }
        
        .sharepoint-modal.active {
            display: flex;
        }
        
        .sharepoint-content {
            background: white;
            border-radius: 12px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .sharepoint-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #F8F9FA;
        }
        
        .sharepoint-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .sharepoint-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #0078D4, #005A9E);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }
        
        .sharepoint-title-text h2 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .sharepoint-breadcrumb {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        .sharepoint-close {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .sharepoint-close:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
        
        .sharepoint-body {
            padding: 24px;
        }
        
        .sharepoint-meta {
            display: flex;
            gap: 24px;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 24px;
            font-size: 13px;
        }
        
        .sharepoint-meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .sharepoint-meta-label {
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .sharepoint-meta-value {
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .sharepoint-section {
            margin-bottom: 32px;
        }
        
        .sharepoint-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 8px;
            background: #000;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .lesson-plan {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 20px;
            line-height: 1.8;
        }
        
        .lesson-plan h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 20px 0 12px 0;
        }
        
        .lesson-plan h3:first-child {
            margin-top: 0;
        }
        
        .lesson-plan ul {
            margin: 8px 0;
            padding-left: 24px;
        }
        
        .lesson-plan li {
            margin: 6px 0;
            color: var(--text-primary);
        }
        
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #0078D4;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            margin-top: 16px;
        }
        
        .download-btn:hover {
            background: #005A9E;
            transform: translateY(-1px);
        }
        
        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        .input-area {
            padding: 16px 24px;
            border-top: 1px solid var(--border);
            background: var(--bg-primary);
        }
        
        .input-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .quick-prompts {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            overflow-x: auto;
            padding-bottom: 4px;
        }
        
        .quick-prompt {
            padding: 6px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }
        
        .quick-prompt:hover {
            background: #E8F2FF;
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .input-wrapper {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }
        
        .attach-btn {
            width: 40px;
            height: 40px;
            background: white;
            color: var(--text-secondary);
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .attach-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .attached-files {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        .attached-file {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .attached-file-name {
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .remove-file {
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1;
        }
        
        .remove-file:hover {
            color: var(--danger);
        }
        
        .input-box {
            flex: 1;
            display: flex;
            align-items: flex-end;
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.2s;
        }
        
        .input-box:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        #messageInput {
            flex: 1;
            border: none;
            outline: none;
            font-size: 14px;
            font-family: inherit;
            resize: none;
            max-height: 120px;
            line-height: 1.5;
        }
        
        .send-btn {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .send-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .send-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
            30% { transform: translateY(-10px); opacity: 1; }
        }
        
        /* ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ */
        .snackbar-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: none;
        }
        
        .snackbar {
            background: #1F2937;
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            max-width: 400px;
            pointer-events: all;
            animation: snackbarSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .snackbar.closing {
            animation: snackbarSlideOut 0.3s cubic-bezier(0.5, 0, 0.75, 0);
        }
        
        @keyframes snackbarSlideIn {
            from {
                opacity: 0;
                transform: translateX(400px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes snackbarSlideOut {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(400px);
            }
        }
        
        .snackbar-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .snackbar-content {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .snackbar-close {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.7);
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .snackbar-close:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -260px;
                height: 100%;
                z-index: 1000;
            }
            
            .sidebar.open {
                left: 0;
            }
            
            .suggestion-grid {
                grid-template-columns: 1fr;
            }
            
            .snackbar-container {
                right: 12px;
                left: 12px;
                top: 12px;
            }
            
            .snackbar {
                min-width: auto;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">ğŸ¤–</div>
                <span>å…ˆç”ŸAI</span>
            </div>
            <button class="new-chat-btn" onclick="newChat()">
                <span style="font-size: 18px; font-weight: 700;">+</span> æ–°ã—ã„ãƒãƒ£ãƒƒãƒˆ
            </button>
        </div>
        
        <div class="schedule-section-wrapper">
            <div class="schedule-section" id="scheduleSection">
                <div class="section-title">ğŸ“… æ™‚é–“å‰²</div>
                
                <!-- ä»Šæ—¥ -->
                <div class="schedule-date-group">
                    <div class="schedule-date-header">ä»Šæ—¥ï¼ˆ10/10 é‡‘ï¼‰</div>
                    <div class="schedule-list">
                        <div class="schedule-item" onclick="createScheduleThread('1é™', '3å¹´2çµ„', 'æ•°å­¦', 'äºŒæ¬¡é–¢æ•°ã®å¿œç”¨', '08:50 - 09:40')">
                            <div class="schedule-time">1é™</div>
                            <div class="schedule-class">3å¹´2çµ„ æ•°å­¦</div>
                            <div class="schedule-subject">äºŒæ¬¡é–¢æ•°ã®å¿œç”¨</div>
                        </div>
                        <div class="schedule-item" onclick="createScheduleThread('3é™', '3å¹´2çµ„', 'æ•°å­¦', 'äºŒæ¬¡é–¢æ•°ã®å¿œç”¨', '10:50 - 11:40')">
                            <div class="schedule-time">3é™</div>
                            <div class="schedule-class">3å¹´2çµ„ æ•°å­¦</div>
                            <div class="schedule-subject">äºŒæ¬¡é–¢æ•°ã®å¿œç”¨</div>
                        </div>
                        <div class="schedule-item" onclick="createScheduleThread('5é™', '3å¹´1çµ„', 'æ•°å­¦', 'äºŒæ¬¡é–¢æ•°ã®åŸºç¤', '13:30 - 14:20')">
                            <div class="schedule-time">5é™</div>
                            <div class="schedule-class">3å¹´1çµ„ æ•°å­¦</div>
                            <div class="schedule-subject">äºŒæ¬¡é–¢æ•°ã®åŸºç¤</div>
                        </div>
                    </div>
                </div>
                
                <!-- æ˜æ—¥ -->
                <div class="schedule-date-group">
                    <div class="schedule-date-header">æ˜æ—¥ï¼ˆ10/11 åœŸï¼‰</div>
                    <div class="schedule-list">
                        <div class="schedule-item" onclick="createScheduleThread('2é™', '3å¹´1çµ„', 'æ•°å­¦', 'äºŒæ¬¡é–¢æ•°ã®å¿œç”¨', '09:50 - 10:40')">
                            <div class="schedule-time">2é™</div>
                            <div class="schedule-class">3å¹´1çµ„ æ•°å­¦</div>
                            <div class="schedule-subject">äºŒæ¬¡é–¢æ•°ã®å¿œç”¨</div>
                        </div>
                        <div class="schedule-item" onclick="createScheduleThread('4é™', '2å¹´3çµ„', 'è‹±èª', 'Present Perfect', '11:50 - 12:40')">
                            <div class="schedule-time">4é™</div>
                            <div class="schedule-class">2å¹´3çµ„ è‹±èª</div>
                            <div class="schedule-subject">Present Perfect</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="resize-handle" id="scheduleResizeHandle"></div>
        </div>
        
        <div class="chat-history-wrapper">
            <div class="chat-history">
                <div class="section-title">â­ ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—</div>
                
                <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¤–ã®ãƒãƒ£ãƒƒãƒˆ -->
                <div class="standalone-chats">
                    <div class="history-item" onclick="loadHistory('ä¸Šç”°äºœå­£ã•ã‚“')">
                        <div class="history-title">ä¸Šç”°äºœå­£ã•ã‚“ã®æœ€è¿‘ã®æ§˜å­</div>
                        <div class="history-date">ä»Šæ—¥ 12:15</div>
                    </div>
                    <div class="history-item" onclick="loadHistory('ä¿è­·è€…ä¼šè³‡æ–™')">
                        <div class="history-title">ä¿è­·è€…ä¼šã®è³‡æ–™ä½œæˆ</div>
                        <div class="history-date">æ˜¨æ—¥ 16:45</div>
                    </div>
                </div>
                
                <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: 3å¹´2çµ„ æ•°å­¦ -->
                <div class="project-group">
                    <div class="project-header collapsed" onclick="toggleProject(this)">
                        <span class="project-icon">ğŸ“</span>
                        <span class="project-name">3å¹´2çµ„ æ•°å­¦</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="project-threads hidden">
                        <div class="project-action-btn" onclick="startProjectThread('3å¹´2çµ„', 'æ•°å­¦')">
                            â• æ–°è¦ã‚¹ãƒ¬ãƒƒãƒ‰
                        </div>
                        <div class="history-item" onclick="loadHistory('å°å…¥ã®ãƒã‚¿')">
                            <div class="history-title">3é™: å°å…¥ã®ãƒã‚¿ã‚’è€ƒãˆã¦</div>
                            <div class="history-date">ä»Šæ—¥ 08:30</div>
                        </div>
                        <div class="history-item" onclick="loadHistory('å”åƒå­¦ç¿’')">
                            <div class="history-title">1é™: å”åƒå­¦ç¿’ã®è¨­è¨ˆ</div>
                            <div class="history-date">ä»Šæ—¥ 07:45</div>
                        </div>
                        <div class="history-item" onclick="loadHistory('æŒ¯ã‚Šè¿”ã‚Šåˆ†æ')">
                            <div class="history-title">å‰å›æˆæ¥­ã®æŒ¯ã‚Šè¿”ã‚Šåˆ†æ</div>
                            <div class="history-date">æ˜¨æ—¥ 15:20</div>
                        </div>
                        <div class="project-action-btn secondary" onclick="viewAllHistory('3å¹´2çµ„', 'æ•°å­¦')">
                            ğŸ“‚ å±¥æ­´ã‚’å…¨éƒ¨è¦‹ã‚‹
                        </div>
                    </div>
                </div>
                
                <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: 3å¹´1çµ„ æ•°å­¦ -->
                <div class="project-group">
                    <div class="project-header collapsed" onclick="toggleProject(this)">
                        <span class="project-icon">ğŸ“</span>
                        <span class="project-name">3å¹´1çµ„ æ•°å­¦</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="project-threads hidden">
                        <div class="project-action-btn" onclick="startProjectThread('3å¹´1çµ„', 'æ•°å­¦')">
                            â• æ–°è¦ã‚¹ãƒ¬ãƒƒãƒ‰
                        </div>
                        <div class="history-item" onclick="loadHistory('P18ã®ç™ºå•')">
                            <div class="history-title">5é™: P18ã®ç™ºå•æ¡ˆã‚’3ã¤</div>
                            <div class="history-date">æ˜¨æ—¥ 13:20</div>
                        </div>
                        <div class="history-item" onclick="loadHistory('å®¿é¡Œè¨­è¨ˆ')">
                            <div class="history-title">ç†è§£åº¦åˆ¥ã®å®¿é¡Œè¨­è¨ˆ</div>
                            <div class="history-date">9/27 14:30</div>
                        </div>
                        <div class="project-action-btn secondary" onclick="viewAllHistory('3å¹´1çµ„', 'æ•°å­¦')">
                            ğŸ“‚ å±¥æ­´ã‚’å…¨éƒ¨è¦‹ã‚‹
                        </div>
                    </div>
                </div>
                
                <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: 2å¹´3çµ„ è‹±èª -->
                <div class="project-group">
                    <div class="project-header collapsed" onclick="toggleProject(this)">
                        <span class="project-icon">ğŸ“</span>
                        <span class="project-name">2å¹´3çµ„ è‹±èª</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="project-threads hidden">
                        <div class="project-action-btn" onclick="startProjectThread('2å¹´3çµ„', 'è‹±èª')">
                            â• æ–°è¦ã‚¹ãƒ¬ãƒƒãƒ‰
                        </div>
                        <div class="history-item" onclick="loadHistory('ãƒªã‚¹ãƒ‹ãƒ³ã‚°æ•™æ')">
                            <div class="history-title">2é™: ãƒªã‚¹ãƒ‹ãƒ³ã‚°æ•™æã®é¸å®š</div>
                            <div class="history-date">9/26 09:15</div>
                        </div>
                        <div class="project-action-btn secondary" onclick="viewAllHistory('2å¹´3çµ„', 'è‹±èª')">
                            ğŸ“‚ å±¥æ­´ã‚’å…¨éƒ¨è¦‹ã‚‹
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ -->
    <div class="main-area">
        <div class="chat-header">
            <div class="context-badge" id="contextBadge">
                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            <button class="data-indicator" onclick="openDataSettings()" style="cursor: pointer; border: 1px solid var(--border); background: white; padding: 6px 12px; border-radius: 8px; transition: all 0.2s;">
                <span class="data-dot"></span>
                <span class="data-label">æ¥ç¶šãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª</span>
            </button>
        </div>
        
        <div class="chat-container" id="chatContainer">
            <div class="welcome-screen" id="welcomeScreen">
                <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            
            <div id="messagesArea"></div>
        </div>
        
        <div class="input-area">
            <div class="input-container">
                <div class="quick-prompts" id="quickPrompts">
                    <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                </div>
                <div id="attachedFiles" class="attached-files"></div>
                <div class="input-wrapper">
                    <button class="attach-btn" onclick="attachFile()" title="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜">
                        ğŸ“
                    </button>
                    <div class="input-box">
                        <textarea 
                            id="messageInput" 
                            placeholder="ä½•ã§ã‚‚èã„ã¦ãã ã•ã„" 
                            rows="1"
                            onkeydown="handleKeyDown(event)"
                            oninput="autoResize(this)"
                        ></textarea>
                    </div>
                    <button class="send-btn" onclick="sendMessage()" id="sendBtn">
                        â¬†ï¸
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div class="snackbar-container" id="snackbarContainer"></div>
    
    <!-- SharePointãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="sharepoint-modal" id="sharepointModal">
        <div class="sharepoint-content">
            <div class="sharepoint-header">
                <div class="sharepoint-title">
                    <div class="sharepoint-icon">ğŸ“‚</div>
                    <div class="sharepoint-title-text">
                        <h2 id="sharepointFileName">ä¸­3_äºŒæ¬¡é–¢æ•°ã®å¿œç”¨_æˆæ¥­æ¡ˆ_45åˆ†.docx</h2>
                        <div class="sharepoint-breadcrumb">å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ > æ•°å­¦ > ä¸­å­¦3å¹´ > äºŒæ¬¡é–¢æ•°</div>
                    </div>
                </div>
                <button class="sharepoint-close" onclick="closeSharePointModal()">Ã—</button>
            </div>
            <div class="sharepoint-body">
                <div class="sharepoint-meta">
                    <div class="sharepoint-meta-item">
                        <span class="sharepoint-meta-label">ä½œæˆè€…</span>
                        <span class="sharepoint-meta-value">å¤§é˜ªå¸‚ç«‹æ±ä¸­å­¦æ ¡ ç”°ä¸­å…ˆç”Ÿ</span>
                    </div>
                    <div class="sharepoint-meta-item">
                        <span class="sharepoint-meta-label">æ•™ç§‘ãƒ»å­¦å¹´</span>
                        <span class="sharepoint-meta-value">æ•°å­¦ / ä¸­3</span>
                    </div>
                    <div class="sharepoint-meta-item">
                        <span class="sharepoint-meta-label">ç™»éŒ²æ—¥</span>
                        <span class="sharepoint-meta-value">2024å¹´6æœˆ12æ—¥</span>
                    </div>
                    <div class="sharepoint-meta-item">
                        <span class="sharepoint-meta-label">å˜å…ƒ</span>
                        <span class="sharepoint-meta-value">äºŒæ¬¡é–¢æ•°ã®å¿œç”¨</span>
                    </div>
                </div>
                
                <div class="sharepoint-section">
                    <div class="sharepoint-section-title">ğŸ¥ å°å…¥å‹•ç”»ï¼ˆ3åˆ†ï¼‰</div>
                    <div class="video-container" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; position: relative; height: 0; padding-bottom: 56.25%;">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: white;">
                            <div style="font-size: 48px; margin-bottom: 12px;">â–¶ï¸</div>
                            <div style="font-size: 16px; font-weight: 600;">ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ã®ã‚·ãƒ¥ãƒ¼ãƒˆè»Œé“</div>
                            <div style="font-size: 13px; opacity: 0.9; margin-top: 8px;">äºŒæ¬¡é–¢æ•°ã®å°å…¥å‹•ç”»ï¼ˆ3åˆ†12ç§’ï¼‰</div>
                        </div>
                    </div>
                    <p style="margin-top: 12px; font-size: 13px; color: var(--text-secondary);">
                        ğŸ“Œ ã“ã®å‹•ç”»ã¯ã€ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ã®ã‚·ãƒ¥ãƒ¼ãƒˆè»Œé“ã‚’ä½¿ã£ã¦äºŒæ¬¡é–¢æ•°ã‚’èº«è¿‘ã«æ„Ÿã˜ã•ã›ã‚‹å°å…¥ã§ã™ã€‚å®Ÿéš›ã®æˆæ¥­ã§ã¯ã€YouTubeç­‰ã®å‹•ç”»ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰å†ç”Ÿã§ãã¾ã™ã€‚
                    </p>
                </div>
                
                <div class="sharepoint-section">
                    <div class="sharepoint-section-title">ğŸ“ æŒ‡å°æ¡ˆï¼ˆ45åˆ†æˆæ¥­ï¼‰</div>
                    <div class="lesson-plan">
                        <h3>ğŸ¯ æœ¬æ™‚ã®ç›®æ¨™</h3>
                        <ul>
                            <li>äºŒæ¬¡é–¢æ•° y = a(x-p)Â² + q ã®ã‚°ãƒ©ãƒ•ã®ç‰¹å¾´ã‚’ç†è§£ã—ã€å®Ÿç”Ÿæ´»ã®äº‹è±¡ã¨é–¢é€£ä»˜ã‘ã¦èª¬æ˜ã§ãã‚‹</li>
                            <li>é ‚ç‚¹ã®åº§æ¨™ã‚„è»¸ã®æ–¹ç¨‹å¼ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹</li>
                            <li>ã‚°ãƒ©ãƒ•ã®é–‹ãæ–¹ã¨aã®å€¤ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹</li>
                        </ul>
                        
                        <h3>ğŸ“š æº–å‚™ç‰©</h3>
                        <ul>
                            <li>ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆç«¯æœ«ï¼ˆ1äºº1å°ï¼‰</li>
                            <li>ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€ŒäºŒæ¬¡é–¢æ•°ã®æ¢æ¤œã€</li>
                            <li>ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ã®ã‚·ãƒ¥ãƒ¼ãƒˆå‹•ç”»ï¼ˆå°å…¥ç”¨ï¼‰</li>
                            <li>ã‚°ãƒ©ãƒ•ä½œæˆã‚¢ãƒ—ãƒªï¼ˆDesmosæ¨å¥¨ï¼‰</li>
                        </ul>
                        
                        <h3>â° å±•é–‹</h3>
                        
                        <strong>å°å…¥ï¼ˆ10åˆ†ï¼‰</strong>
                        <ul>
                            <li>ã€0-3åˆ†ã€‘å‹•ç”»è¦–è´ï¼šãƒã‚¹ã‚±ã®ã‚·ãƒ¥ãƒ¼ãƒˆè»Œé“ã‚’è¦³å¯Ÿ</li>
                            <li>ã€3-5åˆ†ã€‘ç™ºå•ï¼šã€Œã“ã®ãƒœãƒ¼ãƒ«ã®è»Œé“ã€ã©ã‚“ãªå½¢ã‚’ã—ã¦ã„ã‚‹ï¼Ÿæ•°å¼ã§è¡¨ã›ãã†ï¼Ÿã€</li>
                            <li>ã€5-8åˆ†ã€‘å‰æ™‚ã®å¾©ç¿’ï¼šy = axÂ² ã®ã‚°ãƒ©ãƒ•ã®ç‰¹å¾´</li>
                            <li>ã€8-10åˆ†ã€‘æœ¬æ™‚ã®å­¦ç¿’èª²é¡Œã‚’æç¤ºï¼šã€Œã‚°ãƒ©ãƒ•ã‚’è‡ªç”±ã«å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ãªã‚ã†ã€</li>
                        </ul>
                        
                        <strong>å±•é–‹ï¼ˆ30åˆ†ï¼‰</strong>
                        <ul>
                            <li>ã€10-20åˆ†ã€‘ã‚°ãƒ©ãƒ•ã®å¹³è¡Œç§»å‹•ã®ç†è§£
                                <ul>
                                    <li>Desmosã‚’ä½¿ã£ã¦ y = a(x-p)Â² + q ã®p, qã‚’å‹•ã‹ã™ä½“é¨“</li>
                                    <li>ãƒšã‚¢ã§æ°—ã¥ãã‚’å…±æœ‰ï¼šã€Œpã‚’å¤‰ãˆã‚‹ã¨â€¦ã€ã€Œqã‚’å¤‰ãˆã‚‹ã¨â€¦ã€</li>
                                </ul>
                            </li>
                            <li>ã€20-30åˆ†ã€‘ç·´ç¿’å•é¡Œï¼ˆãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆï¼‰
                                <ul>
                                    <li>åŸºç¤ï¼šé ‚ç‚¹ã‚’èª­ã¿å–ã‚‹å•é¡Œï¼ˆ5å•ï¼‰</li>
                                    <li>æ¨™æº–ï¼šå¼ã‹ã‚‰é ‚ç‚¹ã‚’æ±‚ã‚ã‚‹å•é¡Œï¼ˆ3å•ï¼‰</li>
                                    <li>ç™ºå±•ï¼šæ¡ä»¶ã«åˆã†ã‚°ãƒ©ãƒ•ã‚’æãå•é¡Œï¼ˆ2å•ï¼‰</li>
                                </ul>
                            </li>
                            <li>ã€30-35åˆ†ã€‘ã‚°ãƒ«ãƒ¼ãƒ—è¨è­°ï¼šã€Œãªãœã‚·ãƒ¥ãƒ¼ãƒˆã®è»Œé“ã¯æ”¾ç‰©ç·šã«ãªã‚‹ã®ã‹ï¼Ÿã€</li>
                        </ul>
                        
                        <strong>ã¾ã¨ã‚ï¼ˆ5åˆ†ï¼‰</strong>
                        <ul>
                            <li>ã€35-40åˆ†ã€‘æœ¬æ™‚ã®æŒ¯ã‚Šè¿”ã‚Šï¼šã‚ã‹ã£ãŸã“ã¨ãƒ»ç–‘å•ã‚’3è¡Œã§è¨˜å…¥</li>
                            <li>ã€40-45åˆ†ã€‘æ¬¡æ™‚äºˆå‘Šï¼šã€Œå®Ÿéš›ã®å™´æ°´ã‚„ã‚¸ã‚§ãƒƒãƒˆã‚³ãƒ¼ã‚¹ã‚¿ãƒ¼ã®è¨­è¨ˆã«æŒ‘æˆ¦ã—ã‚ˆã†ã€</li>
                        </ul>
                        
                        <h3>ğŸ’¡ æŒ‡å°ä¸Šã®ç•™æ„ç‚¹</h3>
                        <ul>
                            <li>ã‚°ãƒ©ãƒ•ã‚¢ãƒ—ãƒªã®æ“ä½œã«ä¸æ…£ã‚Œãªç”Ÿå¾’ã«ã¯ã€ãƒšã‚¢ã§æ•™ãˆåˆã†æ™‚é–“ã‚’è¨­ã‘ã‚‹</li>
                            <li>ã€Œæ•°å¼ãŒè‹¦æ‰‹ã€ã¨ã„ã†ç”Ÿå¾’ã«ã¯ã€ã¾ãšã‚°ãƒ©ãƒ•ã®è¦–è¦šçš„ç†è§£ã‚’å„ªå…ˆã•ã›ã‚‹</li>
                            <li>ç™ºå±•å±¤ã®ç”Ÿå¾’ã«ã¯ã€Œaã®å€¤ãŒè² ã®å ´åˆã€ã‚’è€ƒãˆã•ã›ã‚‹è¿½åŠ èª²é¡Œã‚’ç”¨æ„</li>
                        </ul>
                        
                        <h3>ğŸ“Š è©•ä¾¡è¦æº–</h3>
                        <ul>
                            <li><strong>çŸ¥è­˜ãƒ»æŠ€èƒ½ï¼š</strong>é ‚ç‚¹ã®åº§æ¨™ã‚’å¼ã‹ã‚‰èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã‚‹</li>
                            <li><strong>æ€è€ƒãƒ»åˆ¤æ–­ãƒ»è¡¨ç¾ï¼š</strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã‚°ãƒ©ãƒ•ã®å¤‰åŒ–ã‚’é–¢é€£ä»˜ã‘ã¦èª¬æ˜ã§ãã‚‹</li>
                            <li><strong>ä¸»ä½“çš„ã«å­¦ç¿’ã«å–ã‚Šçµ„ã‚€æ…‹åº¦ï¼š</strong>ãƒšã‚¢æ´»å‹•ã§ç©æ¥µçš„ã«æ„è¦‹äº¤æ›ã—ã¦ã„ã‚‹</li>
                        </ul>
                    </div>
                    
                    <button type="button" class="download-btn" onclick="downloadFile()">
                        ğŸ’¾ æŒ‡å°æ¡ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆ.docxï¼‰
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ç”Ÿå¾’ã‚«ãƒ«ãƒ†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="sharepoint-modal" id="karteModal">
        <div class="sharepoint-content" style="max-width: 500px;">
            <div class="sharepoint-header" style="background: linear-gradient(135deg, #0066CC 0%, #0052A3 100%);">
                <div class="sharepoint-title">
                    <div class="sharepoint-icon" style="background: white;">
                        <span style="font-size: 20px;">ğŸ“‹</span>
                    </div>
                    <div class="sharepoint-title-text">
                        <h2 style="color: white;">ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ã</h2>
                        <div class="sharepoint-breadcrumb" style="color: rgba(255,255,255,0.8);">ã¾ãªã³ãƒã‚±ãƒƒãƒˆ</div>
                    </div>
                </div>
                <button class="sharepoint-close" onclick="closeKarteModal()" style="color: white;">Ã—</button>
            </div>
            <div class="sharepoint-body" style="text-align: center; padding: 32px;">
                <div style="font-size: 64px; margin-bottom: 16px;">ğŸ“‚</div>
                <h3 style="font-size: 18px; font-weight: 600; color: #1F2937; margin-bottom: 12px;">ã¾ãªã³ãƒã‚±ãƒƒãƒˆã®ç”Ÿå¾’ã‚«ãƒ«ãƒ†ãŒ<br>åˆ¥ç”»é¢ã§é–‹ãã¾ã™</h3>
                <p style="font-size: 14px; color: #6B7280; margin-bottom: 24px;">ä¸Šç”° äºœå­£ã•ã‚“ï¼ˆ6å¹´1çµ„27ç•ªï¼‰ã®<br>è©³ç´°æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button type="button" onclick="closeKarteModal()" style="padding: 12px 24px; background: white; border: 2px solid #E5E7EB; border-radius: 8px; font-size: 14px; font-weight: 600; color: #6B7280; cursor: pointer; transition: all 0.2s;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="button" onclick="openKarteExternal()" style="padding: 12px 24px; background: #0066CC; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; color: white; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px;">
                        <span>é–‹ã</span>
                        <span style="font-size: 16px;">â†—ï¸</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let chatActive = false;
        let attachedFiles = [];
        let currentProject = null;
        let currentContext = null;
        
        // ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼è¡¨ç¤ºé–¢æ•°
        function showSnackbar(message, icon = 'â„¹ï¸', duration = 4000) {
            const container = document.getElementById('snackbarContainer');
            const snackbar = document.createElement('div');
            snackbar.className = 'snackbar';
            
            snackbar.innerHTML = `
                <span class="snackbar-icon">${icon}</span>
                <div class="snackbar-content">${message}</div>
                <button class="snackbar-close" onclick="closeSnackbar(this)">Ã—</button>
            `;
            
            container.appendChild(snackbar);
            
            setTimeout(() => {
                closeSnackbar(snackbar.querySelector('.snackbar-close'));
            }, duration);
        }
        
        function closeSnackbar(closeBtn) {
            const snackbar = closeBtn.closest('.snackbar');
            snackbar.classList.add('closing');
            setTimeout(() => {
                snackbar.remove();
            }, 300);
        }
        
        // ç”Ÿå¾’ã‚«ãƒ«ãƒ†ãƒ¢ãƒ¼ãƒ€ãƒ«
        function openKarteModal() {
            const modal = document.getElementById('karteModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeKarteModal() {
            const modal = document.getElementById('karteModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function openKarteExternal() {
            closeKarteModal();
            showSnackbar('ã¾ãªã³ãƒã‚±ãƒƒãƒˆã®ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’åˆ¥ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸï¼ˆãƒ‡ãƒ¢ï¼‰', 'âœ…', 3000);
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', function() {
            updateHeader();
            updateWelcomeMessage();
            updateQuickPrompts();
        });
        
        // ã‚¯ã‚¤ãƒƒã‚¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ›´æ–°
        function updateQuickPrompts() {
            const quickPromptsContainer = document.getElementById('quickPrompts');
            const messageInput = document.getElementById('messageInput');
            
            if (!currentContext) {
                quickPromptsContainer.innerHTML = '';
                quickPromptsContainer.style.display = 'none';
                messageInput.placeholder = 'ä½•ã§ã‚‚èã„ã¦ãã ã•ã„';
                return;
            }
            
            quickPromptsContainer.style.display = 'flex';
            
            // æ™‚é™æƒ…å ±ãŒã‚ã‚‹å ´åˆï¼ˆæ™‚é–“å‰²ã‹ã‚‰é–‹å§‹ï¼‰
            if (currentContext.period) {
                messageInput.placeholder = 'ä½•ã§ã‚‚èã„ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šå°å…¥è€ƒãˆã¦ï¼‰';
                quickPromptsContainer.innerHTML = `
                    <div class="quick-prompt" onclick="useSuggestion('å°å…¥è€ƒãˆã¦')">ğŸ’¡ å°å…¥è€ƒãˆã¦</div>
                    <div class="quick-prompt" onclick="useSuggestion('ç™ºå•æ¡ˆã‚’3ã¤')">â“ ç™ºå•æ¡ˆã‚’3ã¤</div>
                    <div class="quick-prompt" onclick="useSuggestion('å”åƒå­¦ç¿’ã®è¨­è¨ˆ')">ğŸ‘¥ å”åƒå­¦ç¿’ã®è¨­è¨ˆ</div>
                    <div class="quick-prompt" onclick="useSuggestion('ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰ä¼¼ãŸæˆæ¥­æ¡ˆã‚’æ¢ã—ã¦')">ğŸ“‚ ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰æ¢ã™</div>
                `;
            } else {
                // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰é–‹å§‹ï¼ˆæ™‚é™æƒ…å ±ãªã—ï¼‰
                messageInput.placeholder = 'ä½•ã§ã‚‚èã„ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šå¹´é–“è¨ˆç”»ã‚’ç¢ºèªï¼‰';
                quickPromptsContainer.innerHTML = `
                    <div class="quick-prompt" onclick="useSuggestion('å¹´é–“è¨ˆç”»ã‚’ç¢ºèª')">ğŸ“… å¹´é–“è¨ˆç”»ã‚’ç¢ºèª</div>
                    <div class="quick-prompt" onclick="useSuggestion('è©•ä¾¡åŸºæº–ã‚’ç›¸è«‡')">ğŸ“ è©•ä¾¡åŸºæº–ã‚’ç›¸è«‡</div>
                    <div class="quick-prompt" onclick="useSuggestion('ã“ã®å˜å…ƒã®æ•™æã‚’ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰æ¢ã—ã¦')">ğŸ“‚ æ•™æã‚’æ¢ã™</div>
                    <div class="quick-prompt" onclick="useSuggestion('ã“ã®ã‚¯ãƒ©ã‚¹ã®å‚¾å‘')">ğŸ“Š ã“ã®ã‚¯ãƒ©ã‚¹ã®å‚¾å‘</div>
                `;
            }
        }
        
        // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¹ãƒ¬ãƒƒãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
        function createScheduleThread(period, classNum, subject, topic, time) {
            const projectName = `${classNum} ${subject}`;
            currentProject = projectName;
            currentContext = {
                period: period,
                classNum: classNum,
                subject: subject,
                topic: topic,
                time: time
            };
            
            chatActive = false;
            document.getElementById('messagesArea').innerHTML = '';
            document.getElementById('welcomeScreen').style.display = 'flex';
            document.getElementById('messageInput').value = '';
            
            updateHeader();
            updateWelcomeMessage();
            updateQuickPrompts();
            highlightScheduleItem();
        }
        
        function updateHeader() {
            const headerBadges = document.getElementById('contextBadge');
            
            if (!currentContext) {
                headerBadges.innerHTML = '';
                return;
            }
            
            if (currentContext.period) {
                headerBadges.innerHTML = `
                    <span class="badge project-badge">
                        <span class="badge-icon">ğŸ“</span>
                        <span>${currentContext.classNum} ${currentContext.subject}</span>
                    </span>
                    <span class="badge context-badge-item">${currentContext.period} ${currentContext.topic}</span>
                `;
            } else {
                headerBadges.innerHTML = `
                    <span class="badge project-badge">
                        <span class="badge-icon">ğŸ“</span>
                        <span>${currentContext.classNum} ${currentContext.subject}</span>
                    </span>
                `;
            }
        }
        
        function updateWelcomeMessage() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            if (!currentContext) {
                welcomeScreen.innerHTML = `
                    <div class="welcome-icon">ğŸ‘‹</div>
                    <div class="welcome-title">ã“ã‚“ã«ã¡ã¯ã€éˆ´æœ¨å…ˆç”Ÿ</div>
                    <div class="welcome-subtitle">
                        å…ˆç”ŸAIã¸ã‚ˆã†ã“ãã€‚ãªã‚“ã§ã‚‚èã„ã¦ã­ã€‚
                    </div>
                    <div class="welcome-hint">
                        ğŸ’¡ æˆæ¥­æƒ…å ±ã‚’å–ã‚Šå…¥ã‚Œã‚‹å ´åˆã¯ã€æ™‚é–“å‰²ã‹ã‚‰ã‚¹ãƒãƒ¼ãƒˆã‚¹ãƒ¬ãƒƒãƒ‰ã‚’é–‹å§‹ã§ãã¾ã™ã€‚
                    </div>
                `;
                return;
            }
            
            if (currentContext.period) {
                // æ™‚é–“å‰²ã‹ã‚‰é–‹å§‹ï¼ˆã‚¹ãƒãƒ¼ãƒˆã‚¹ãƒ¬ãƒƒãƒ‰ï¼‰
                welcomeScreen.innerHTML = `
                    <div class="welcome-icon">âœ¨</div>
                    <div class="welcome-title">ã‚¹ãƒãƒ¼ãƒˆã‚¹ãƒ¬ãƒƒãƒ‰</div>
                    <div class="welcome-subtitle">
                        ${currentContext.classNum}ã®${currentContext.period}ï¼ˆ${currentContext.topic}ï¼‰ã«ã¤ã„ã¦
                    </div>
                    <div class="preset-info">
                        <span class="preset-label">ğŸ“Œ</span>
                        <div class="preset-tags">
                            <span class="preset-tag">${currentContext.classNum}</span>
                            <span class="preset-tag">${currentContext.subject}</span>
                            <span class="preset-tag dynamic">${currentContext.topic}</span>
                        </div>
                    </div>
                    <div class="suggestion-grid" style="margin-top: 24px;">
                        <div class="suggestion-card" onclick="useSuggestion('å°å…¥è€ƒãˆã¦')">
                            <div class="suggestion-icon">ğŸš€</div>
                            <div class="suggestion-text">å°å…¥è€ƒãˆã¦</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰ä¼¼ãŸæˆæ¥­æ¡ˆã‚’æ¢ã—ã¦')">
                            <div class="suggestion-icon">ğŸ“‚</div>
                            <div class="suggestion-text">ä¼¼ãŸæˆæ¥­æ¡ˆã‚’æ¢ã™</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('ã“ã®ã‚¯ãƒ©ã‚¹ã®æœ€è¿‘ã®æ§˜å­ã¯ï¼Ÿ')">
                            <div class="suggestion-icon">ğŸ“Š</div>
                            <div class="suggestion-text">ã“ã®ã‚¯ãƒ©ã‚¹ã®æœ€è¿‘ã®æ§˜å­ã¯ï¼Ÿ</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('å”åƒå­¦ç¿’ã®è¨­è¨ˆã—ã¦')">
                            <div class="suggestion-icon">ğŸ‘¥</div>
                            <div class="suggestion-text">å”åƒå­¦ç¿’ã®è¨­è¨ˆã—ã¦</div>
                        </div>
                    </div>
                `;
            } else {
                // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰é–‹å§‹
                welcomeScreen.innerHTML = `
                    <div class="welcome-icon">ğŸ“</div>
                    <div class="welcome-title">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</div>
                    <div class="welcome-subtitle">
                        ${currentContext.classNum} ${currentContext.subject}ã«ã¤ã„ã¦
                    </div>
                    <div class="preset-info">
                        <span class="preset-label">ğŸ“Œ</span>
                        <div class="preset-tags">
                            <span class="preset-tag">${currentContext.classNum}</span>
                            <span class="preset-tag">${currentContext.subject}</span>
                        </div>
                    </div>
                    <div class="suggestion-grid" style="margin-top: 24px;">
                        <div class="suggestion-card" onclick="useSuggestion('ã“ã®å˜å…ƒã®æ•™æã‚’ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰æ¢ã—ã¦')">
                            <div class="suggestion-icon">ğŸ“‚</div>
                            <div class="suggestion-text">æ•™æã‚’æ¢ã™</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('å¹´é–“è¨ˆç”»ã‚’ç¢ºèª')">
                            <div class="suggestion-icon">ğŸ“…</div>
                            <div class="suggestion-text">å¹´é–“è¨ˆç”»ã‚’ç¢ºèª</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('è©•ä¾¡åŸºæº–ã‚’ç›¸è«‡')">
                            <div class="suggestion-icon">ğŸ“</div>
                            <div class="suggestion-text">è©•ä¾¡åŸºæº–ã‚’ç›¸è«‡</div>
                        </div>
                        <div class="suggestion-card" onclick="useSuggestion('ã“ã®ã‚¯ãƒ©ã‚¹ã®æœ€è¿‘ã®æ§˜å­ã¯ï¼Ÿ')">
                            <div class="suggestion-icon">ğŸ“Š</div>
                            <div class="suggestion-text">ã“ã®ã‚¯ãƒ©ã‚¹ã®æ§˜å­</div>
                        </div>
                    </div>
                `;
            }
        }
        
        function highlightScheduleItem() {
            document.querySelectorAll('.schedule-item').forEach(item => {
                item.classList.remove('active');
            });
        }
        
        function toggleProject(element) {
            element.classList.toggle('collapsed');
            const threads = element.nextElementSibling;
            threads.classList.toggle('hidden');
        }
        
        function startProjectThread(classNum, subject) {
            currentProject = `${classNum} ${subject}`;
            currentContext = {
                period: '',
                classNum: classNum,
                subject: subject,
                topic: '',
                time: ''
            };
            
            chatActive = false;
            document.getElementById('messagesArea').innerHTML = '';
            document.getElementById('welcomeScreen').style.display = 'flex';
            document.getElementById('messageInput').value = '';
            
            updateHeader();
            updateWelcomeMessage();
            updateQuickPrompts();
        }
        
        function viewAllHistory(classNum, subject) {
            showSnackbar(`${classNum} ${subject}ã®å…¨å±¥æ­´ã‚’è¡¨ç¤ºã—ã¾ã™ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãŸã‚æœªå®Ÿè£…ï¼‰`, 'ğŸ“‚', 3000);
        }
        
        function showProjectSelector() {
            const projects = [
                '3å¹´2çµ„ æ•°å­¦',
                '3å¹´1çµ„ æ•°å­¦',
                '2å¹´3çµ„ è‹±èª'
            ];
            
            const projectList = projects.map(p => `â€¢ ${p}`).join('<br>');
            
            showSnackbar(`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã—ã¦ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹<br><br>${projectList}<br><br>ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãŸã‚æœªå®Ÿè£…ï¼‰`, 'ğŸ“', 5000);
        }
        
        function scrollToSchedule() {
            document.querySelector('.schedule-section').scrollIntoView({ behavior: 'smooth' });
            const scheduleSection = document.querySelector('.schedule-section');
            scheduleSection.style.backgroundColor = '#FEF3C7';
            setTimeout(() => {
                scheduleSection.style.backgroundColor = '';
            }, 1500);
        }
        
        function newChat() {
            currentProject = null;
            currentContext = null;
            
            chatActive = false;
            document.getElementById('messagesArea').innerHTML = '';
            document.getElementById('welcomeScreen').style.display = 'flex';
            document.getElementById('messageInput').value = '';
            
            updateHeader();
            updateWelcomeMessage();
            updateQuickPrompts();
        }
        
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }
        
        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        function attachFile() {
            const fileTypes = [
                { name: 'æˆæ¥­æ¡ˆ_äºŒæ¬¡é–¢æ•°.docx', type: 'ğŸ“„' },
                { name: 'ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ_æ”¾ç‰©ç·š.pdf', type: 'ğŸ“‘' },
                { name: 'å‰å›ãƒ†ã‚¹ãƒˆçµæœ.xlsx', type: 'ğŸ“Š' },
                { name: 'å‚è€ƒè³‡æ–™_å®Ÿç”Ÿæ´»ã®å¿œç”¨.pptx', type: 'ğŸ“Š' }
            ];
            
            const randomFile = fileTypes[Math.floor(Math.random() * fileTypes.length)];
            const fileId = Date.now();
            
            attachedFiles.push({ id: fileId, name: randomFile.name, type: randomFile.type });
            renderAttachedFiles();
        }
        
        function removeFile(fileId) {
            attachedFiles = attachedFiles.filter(f => f.id !== fileId);
            renderAttachedFiles();
        }
        
        function renderAttachedFiles() {
            const container = document.getElementById('attachedFiles');
            if (attachedFiles.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = attachedFiles.map(file => `
                <div class="attached-file">
                    <span>${file.type}</span>
                    <span class="attached-file-name">${file.name}</span>
                    <span class="remove-file" onclick="removeFile(${file.id})">Ã—</span>
                </div>
            `).join('');
        }
        
        function useSuggestion(text) {
            document.getElementById('messageInput').value = text;
            sendMessage();
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message && attachedFiles.length === 0) return;
            
            if (!chatActive) {
                document.getElementById('welcomeScreen').style.display = 'none';
                chatActive = true;
            }
            
            let fileInfo = '';
            if (attachedFiles.length > 0) {
                fileInfo = '<div style="margin-top: 8px; display: flex; gap: 6px; flex-wrap: wrap;">' +
                    attachedFiles.map(f => `<span style="padding: 4px 8px; background: var(--bg-secondary); border-radius: 6px; font-size: 11px;">${f.type} ${f.name}</span>`).join('') +
                    '</div>';
            }
            
            addMessage('user', (message || 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ã¾ã—ãŸ') + fileInfo);
            
            input.value = '';
            input.style.height = 'auto';
            attachedFiles = [];
            renderAttachedFiles();
            
            showTyping();
            
            setTimeout(() => {
                hideTyping();
                const response = generateResponse(message);
                addMessage('assistant', response.text, response.sources);
            }, 1500);
        }
        
        function addMessage(role, text, sources = []) {
            const messagesArea = document.getElementById('messagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const avatar = role === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–';
            
            let sourceBadges = '';
            if (sources.length > 0) {
                sourceBadges = '<div class="message-meta">' +
                    sources.map(s => `<span class="source-badge">ğŸ“Š ${s}</span>`).join('') +
                    '</div>';
            }
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <div class="message-text">${text}</div>
                    ${sourceBadges}
                </div>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        
        function showTyping() {
            const messagesArea = document.getElementById('messagesArea');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="message-avatar">ğŸ¤–</div>
                <div class="message-content">
                    <div class="message-text">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            messagesArea.appendChild(typingDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        
        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }
        
        // ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰é€£æºãƒ¢ãƒƒã‚¯ - å¿œç­”ç”Ÿæˆ
        function generateResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰æ¤œç´¢ã®ãƒˆãƒªã‚¬ãƒ¼
            if (lowerMessage.includes('ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰') || lowerMessage.includes('æ•™ææ¡ˆ') || 
                lowerMessage.includes('ä¼¼ãŸæˆæ¥­æ¡ˆ') || lowerMessage.includes('ä»–ã®å…ˆç”Ÿã®å®Ÿè·µ') ||
                lowerMessage.includes('æ•™æã‚’') || lowerMessage.includes('æ•™æã‚’ãƒŠãƒ¬ãƒƒã‚¸')) {
                
                const topic = currentContext?.topic || 'äºŒæ¬¡é–¢æ•°';
                const subject = currentContext?.subject || 'æ•°å­¦';
                
                return {
                    text: `<strong>å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ï¼ˆSharePointï¼‰ã‹ã‚‰ã€ã€Œ${topic}ã€ã®æˆæ¥­æ¡ˆã‚’3ä»¶è¦‹ã¤ã‘ã¾ã—ãŸã€‚</strong><br><br>
ã‚¯ãƒ©ã‚¹ã®çŠ¶æ³ã«è¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚<br><br>

<div class="knowledge-card">
    <div class="knowledge-card-title">
        ğŸ“„ ä¸­3_äºŒæ¬¡é–¢æ•°ã®å¿œç”¨_æˆæ¥­æ¡ˆ_45åˆ†.docx
    </div>
    <div class="knowledge-card-meta">
        <div class="knowledge-card-meta-item">ğŸ‘¤ å¤§é˜ªå¸‚ç«‹æ±ä¸­å­¦æ ¡ ç”°ä¸­å…ˆç”Ÿ</div>
        <div class="knowledge-card-meta-item">ğŸ“š ${subject} / ä¸­3</div>
        <div class="knowledge-card-meta-item">ğŸ“… 2024-06-12</div>
    </div>
    <button type="button" class="knowledge-card-btn" onclick="openKnowledgeItem('ä¸­3_äºŒæ¬¡é–¢æ•°ã®å¿œç”¨_æˆæ¥­æ¡ˆ_45åˆ†.docx')">
        ğŸ“‚ ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰é–‹ã
    </button>
</div>

<div class="knowledge-card">
    <div class="knowledge-card-title">
        ğŸ“Š ä¸­3_äºŒæ¬¡é–¢æ•°_å®Ÿç”Ÿæ´»ã¨ã®ã¤ãªãŒã‚Š.pptx
    </div>
    <div class="knowledge-card-meta">
        <div class="knowledge-card-meta-item">ğŸ‘¤ å¤§é˜ªå¸‚ç«‹è¥¿ä¸­å­¦æ ¡ ä½è—¤å…ˆç”Ÿ</div>
        <div class="knowledge-card-meta-item">ğŸ“š ${subject} / ä¸­3</div>
        <div class="knowledge-card-meta-item">ğŸ“… 2024-05-28</div>
    </div>
    <button type="button" class="knowledge-card-btn" onclick="openKnowledgeItem('ä¸­3_äºŒæ¬¡é–¢æ•°_å®Ÿç”Ÿæ´»ã¨ã®ã¤ãªãŒã‚Š.pptx')">
        ğŸ“‚ ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰é–‹ã
    </button>
</div>

<div class="knowledge-card">
    <div class="knowledge-card-title">
        ğŸ“ äºŒæ¬¡é–¢æ•°_ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨æŒ‡å°æ¡ˆ.pdf
    </div>
    <div class="knowledge-card-meta">
        <div class="knowledge-card-meta-item">ğŸ‘¤ å¤§é˜ªå¸‚ç«‹å—ä¸­å­¦æ ¡ å±±ç”°å…ˆç”Ÿ</div>
        <div class="knowledge-card-meta-item">ğŸ“š ${subject} / ä¸­3</div>
        <div class="knowledge-card-meta-item">ğŸ“… 2024-04-15</div>
    </div>
    <button type="button" class="knowledge-card-btn" onclick="openKnowledgeItem('äºŒæ¬¡é–¢æ•°_ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨æŒ‡å°æ¡ˆ.pdf')">
        ğŸ“‚ ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ã‹ã‚‰é–‹ã
    </button>
</div>`,
                    sources: [
                        'å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ / ä¸­3_äºŒæ¬¡é–¢æ•°ã®å¿œç”¨_æˆæ¥­æ¡ˆ_45åˆ†.docx',
                        'å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ / ä¸­3_äºŒæ¬¡é–¢æ•°_å®Ÿç”Ÿæ´»ã¨ã®ã¤ãªãŒã‚Š.pptx',
                        'å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ / äºŒæ¬¡é–¢æ•°_ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨æŒ‡å°æ¡ˆ.pdf'
                    ]
                };
            }
            
            if (!currentContext) {
                if (lowerMessage.includes('ä¸Šç”°') && lowerMessage.includes('æ§˜å­')) {
                    // åˆæœŸè¡¨ç¤ºï¼šæ³¨æ„äº‹é …ã®ã¿ + ã‚«ãƒ†ã‚´ãƒªé¸æŠè‚¢
                    return {
                        text: `<strong>ğŸ‘©â€ğŸ“ ä¸Šç”° äºœå­£ã•ã‚“ï¼ˆ6å¹´1çµ„27ç•ªï¼‰</strong><br><br>

<div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
âš ï¸ <strong>æ³¨æ„ãŒå¿…è¦ãªçŠ¶æ³</strong><br>
ç›´è¿‘1é€±é–“ã€<span style="color: #DC2626; font-weight: 600;">æ—©é€€ã‚„é…åˆ»ãŒç¶šã„ã¦ãŠã‚Š</span>ã€å¿ƒã‚„ä½“ã®èª¿å­ãŒå°‘ã—æ°—ã«ãªã‚‹ã¨ã“ã‚ã§ã™ã€‚å¿ƒã®å¥åº·è¦³å¯Ÿã§ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ã¾ã™ã€‚
</div>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

è©³ã—ãç¢ºèªã—ãŸã„é …ç›®ã‚’é¸ã‚“ã§ãã ã•ã„ï¼š<br><br>

<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>`,
                        sources: ['ã¾ãªã³ãƒã‚±ãƒƒãƒˆç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'å¿ƒã®å¥åº·è¦³å¯Ÿ']
                    };
                } else if (lowerMessage.includes('ä¸Šç”°') && lowerMessage.includes('å­¦æ ¡ç”Ÿæ´»')) {
                    // å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã®è©³ç´°
                    return {
                        text: `<strong>ğŸ« ä¸Šç”°äºœå­£ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</strong><br><br>

<strong>ğŸ“Š å‡ºæ¬ çŠ¶æ³ï¼š</strong><br>
â€¢ æ¬ å¸­æ—¥æ•°ï¼š<span style="color: #0066CC; font-weight: 600;">10æ—¥</span><br>
â€¢ é…åˆ»æ—¥æ•°ï¼š<span style="color: #DC2626; font-weight: 600;">14æ—¥</span>ï¼ˆæ³¨æ„ï¼‰<br>
â€¢ æ—©é€€æ—¥æ•°ï¼š<span style="color: #F59E0B; font-weight: 600;">8æ—¥</span>ï¼ˆæ³¨æ„ï¼‰<br>
â€¢ ä¿å¥å®¤æ¥å®¤æ•°ï¼š<span style="color: #6B7280;">2æ—¥</span><br><br>

<strong>ğŸ¥ ä¿å¥å®¤åˆ©ç”¨çŠ¶æ³ï¼ˆä»Šå¹´åº¦ï¼‰ï¼š</strong><br>
â€¢ 03/05 12:10 ã‘ãŒ - çªãæŒ‡ï¼ˆæŒ‡ï¼‰- å†·å´<br>
â€¢ 03/04 09:01 ç—…æ°— - å’³ - æ•™å®¤å¾©å¸°ã—ã¦çµŒéè¦³å¯Ÿ<br>
â€¢ 03/04 - ãã®ä»– - ä¿å¥å®¤ç™»æ ¡<br>
â€¢ 03/04 - ã‘ãŒ - åˆºå‰µï¼ˆé ­éƒ¨ï¼‰- åŒ»ç™‚æ©Ÿé–¢ã¸ã®æ¬é€<br><br>

<strong>ğŸ’š å¿ƒã®å¥åº·è¦³å¯Ÿï¼š</strong><br>
â€¢ ç›´è¿‘ã§ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã‚³ãƒ¡ãƒ³ãƒˆ<br>
â€¢ å¿ƒã®å¥åº·è¦³å¯Ÿã§ã¯3ä»¥ä¸Šã®å›ç­”ãŒå¤šã„<br>
â€¢ é•·æœŸçš„ã«è¦‹ã‚‹ã¨ã€æ¬ å¸­æ•°ã¯å­¦å¹´å¹³å‡ã‚ˆã‚Š1.8å›/æœˆå°‘ãªã„ãŸã‚ã€åŸºæœ¬çš„ã«ã¯å•é¡Œãªãé€šå­¦<br><br>

<strong>ğŸ“ æ—¥å¸¸æ‰€è¦‹ï¼ˆç›´è¿‘30æ—¥é–“ï¼‰ï¼š</strong><br>
â€¢ 12/05 <span style="background: #DBEAFE; padding: 2px 6px; border-radius: 4px; font-size: 11px;">ç®—æ•°</span> æˆæ¥­ä¸­ã«å¯ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ï¼ˆå²¡é‡ã‚ã‚Šã•å…ˆç”Ÿï¼‰<br>
â€¢ 10/02 <span style="background: #D1FAE5; padding: 2px 6px; border-radius: 4px; font-size: 11px;">è¡¨å½°</span> ä½œæ–‡ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«ã§å¤§è³ã‚’å—è³ï¼ˆå²¡é‡ã‚ã‚Šã•å…ˆç”Ÿï¼‰<br>
â€¢ 06/04 <span style="background: #FEE2E2; padding: 2px 6px; border-radius: 4px; font-size: 11px;">ã‚¯ãƒ©ãƒ–</span> ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ã«ãªã‚Šã¾ã—ãŸï¼ˆå²¡é‡ã‚ã‚Šã•å…ˆç”Ÿï¼‰<br><br>

<strong>ğŸ“ˆ AIãƒ¬ãƒãƒ¼ãƒˆã‚µãƒãƒªãƒ¼ï¼ˆç”Ÿæ´»é¢ï¼‰ï¼š</strong><br>
<div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 12px; border-radius: 8px;">
ç›´è¿‘1é€±é–“ã®é–“ã«å¿ƒã®å¥åº·è¦³å¯Ÿã¨ä¿å¥å®¤åˆ©ç”¨çŠ¶æ³ã«æ°—ã«ã‹ã‘ãŸã„å¤‰åŒ–ã‚ã‚Š â¬‡ï¸
</div><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>

<strong>ğŸ’¡ ãŠã™ã™ã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’¬ å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å¿ƒã®å¥åº·è¦³å¯Ÿã®æ¨ç§»ã‚’è©³ã—ã')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’š å¿ƒã®å¥åº·è¦³å¯Ÿã®æ¨ç§»</button>
<button type="button" onclick="useSuggestion('ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¸ã®ç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ¥ SCç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ</button>
</div>`,
                        sources: ['ã¾ãªã³ãƒã‚±ãƒƒãƒˆç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'æ ¡å‹™ã‚·ã‚¹ãƒ†ãƒ ', 'å¿ƒã®å¥åº·è¦³å¯Ÿ', 'ä¿å¥å®¤åˆ©ç”¨çŠ¶æ³']
                    };
                } else if (lowerMessage.includes('ä¸Šç”°') && lowerMessage.includes('å­¦ç¿’çŠ¶æ³')) {
                    // å­¦ç¿’çŠ¶æ³ã®è©³ç´°
                    return {
                        text: `<strong>ğŸ“š ä¸Šç”°äºœå­£ã•ã‚“ã®å­¦ç¿’çŠ¶æ³</strong><br><br>

<strong>ğŸ“Š å®šæœŸãƒ†ã‚¹ãƒˆçµæœï¼ˆç›´è¿‘180æ—¥é–“ï¼‰ï¼š</strong><br>
â€¢ å›½èªï¼š<span style="color: #10B981; font-weight: 600;">97ç‚¹</span>ï¼ˆå¹³å‡ã‚’å¤§å¹…ã«ä¸Šå›ã‚‹ï¼‰<br>
â€¢ ç®—æ•°ãƒ»æ•°å­¦ï¼š<span style="color: #DC2626; font-weight: 600;">67ç‚¹</span>ï¼ˆè‹¦æ‰‹ãªæ§˜å­ï¼‰<br>
â€¢ ç†ç§‘ï¼š<span style="color: #10B981; font-weight: 600;">96ç‚¹</span><br>
â€¢ ç¤¾ä¼šï¼š<span style="color: #10B981; font-weight: 600;">92ç‚¹</span><br>
â€¢ è‹±èªï¼š<span style="color: #10B981; font-weight: 600;">91ç‚¹</span><br><br>

<strong>ğŸ“ˆ å˜å…ƒãƒ†ã‚¹ãƒˆæ¨ç§»ï¼ˆç®—æ•°ï¼‰ï¼š</strong><br>
åˆ†æ•°ã®å‰²ã‚Šç®—ã§æˆç¸¾ãŒä¸‹ãŒã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚<br><br>

<strong>ğŸ“ å­¦ç¿’ã‚¢ãƒ—ãƒªå®Ÿæ–½çŠ¶æ³ï¼ˆç›´è¿‘7æ—¥é–“ï¼‰ï¼š</strong><br>
â€¢ ç®—æ•°/æ•°å­¦ã€Œæ¬¡æ•°ï¼ˆç¢ºèªãƒ†ã‚¹ãƒˆï¼‰æœ€å°å…¬å€...ã€- å­¦ç¿’æŒ‡ç¤º - æ¨™æº– - 12/25å®Ÿæ–½ - åˆå›78ç‚¹â†’æœ€çµ‚90ç‚¹<br>
â€¢ ç†ç§‘ã€Œãƒ¡ãƒ€ã‚«ã®èª•ç”Ÿã€- å­¦ç¿’æŒ‡ç¤º - åŸºæœ¬ - 12/24å®Ÿæ–½ - åˆå›50ç‚¹â†’æœ€çµ‚50ç‚¹<br>
â€¢ ç†ç§‘ã€Œé…¸æ€§ãƒ»ä¸­æ€§ãƒ»ã‚¢ãƒ«ã‚«ãƒªæ€§ã€- è‡ªä¸»å­¦ç¿’ - åŸºæœ¬ - 12/20å®Ÿæ–½ - åˆå›51ç‚¹â†’æœ€çµ‚60ç‚¹<br>
â€¢ å›½èªã€Œã”ã‚“ãã¤ã­ã€- å­¦ç¿’æŒ‡ç¤º - åŸºæœ¬ - 12/20å®Ÿæ–½ - åˆå›51ç‚¹â†’æœ€çµ‚56ç‚¹<br>
â€¢ å¤–å›½èªã€ŒLesson6 å½¼ã‚‰ã¯ã€œã€- å­¦ç¿’æŒ‡ç¤º - åŸºæœ¬ - 12/14å®Ÿæ–½ - åˆå›31ç‚¹â†’æœ€çµ‚70ç‚¹<br><br>

<strong>âœ¨ ãƒ‰ãƒªãƒ«ãƒ‘ãƒ¼ã‚¯å–ã‚Šçµ„ã¿çŠ¶æ³ï¼š</strong><br>
<div style="background: #D1FAE5; border-left: 4px solid #10B981; padding: 12px; border-radius: 8px;">
ã“ã“1ã‹æœˆã¯å­¦ç¿’ã‚¢ãƒ—ãƒªã‚’ç†±å¿ƒã«å–ã‚Šçµ„ã¿ä¸­ â¬†ï¸<br>
å­¦ç¿’ã‚¢ãƒ—ãƒªã§ã¯ä½•åº¦ã‚‚ãƒˆãƒ©ã‚¤ã—ã¦åˆå›å¾—ç‚¹ã‹ã‚‰ç‚¹æ•°ã‚’ä¼¸ã°ã—ã¦ãŠã‚Šè‹¦æ‰‹ã‚’ãªãã—ã¦ã„ãåŠªåŠ›ãŒå‡ºæ¥ã¦ã„ã¾ã™ã€‚
</div><br>

<strong>ğŸ“Š ScTNè³ªå•ç´™ã€Œå­¦ã³ã«å‘ã‹ã†åŠ›ã€ï¼š</strong><br>
ã‚¹ã‚³ã‚¢ã‚‚ã‚¯ãƒ©ã‚¹å¹³å‡ã‚’å¤§ããä¸Šå›ã£ã¦ã„ã¾ã™ã€‚<br><br>

<strong>ğŸ“ å‚¾å‘ï¼š</strong><br>
å›½èªã¨å¤–å›½èªã®å˜å…ƒãƒ†ã‚¹ãƒˆã®ç‚¹æ•°ã¯å¹³å‡ã‚’å¤§å¹…ã«ä¸Šå›ã‚‹ã“ã¨ãŒå¤šã„ãŒã€<span style="color: #DC2626; font-weight: 600;">ç®—æ•°ã¯è‹¦æ‰‹ãªæ§˜å­</span>ã€‚ç®—æ•°ã®æˆæ¥­ã§å±…çœ ã‚ŠãŒæŒ‡æ‘˜ã•ã‚Œã¦ãŠã‚Šå­¦æœŸæœ«ãƒ†ã‚¹ãƒˆãƒ»å˜å…ƒãƒ†ã‚¹ãƒˆã®çµæœã§ã¯ã€ç®—æ•°ãŒä»–æ•™ç§‘ã«æ¯”ã¹ã¦ã‚„ã‚„ä½ã‚ï¼ˆã‚¯ãƒ©ã‚¹å¹³å‡ã‚ˆã‚Šä¸‹ï¼‰ã§ã™ã€‚<br><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>

<strong>ğŸ’¡ ãŠã™ã™ã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç®—æ•°ã®å€‹åˆ¥æ”¯æ´è¨ˆç”»ã‚’è€ƒãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ“š ç®—æ•°ã®å€‹åˆ¥æ”¯æ´è¨ˆç”»</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’¬ å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦</button>
</div>`,
                        sources: ['ã¾ãªã³ãƒã‚±ãƒƒãƒˆç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'æ ¡å‹™ã‚·ã‚¹ãƒ†ãƒ ', 'ãƒ‰ãƒªãƒ«ãƒ‘ãƒ¼ã‚¯å­¦ç¿’å±¥æ­´', 'ScTNè³ªå•ç´™']
                    };
                } else if (lowerMessage.includes('ä¸Šç”°') && lowerMessage.includes('ç•™æ„äº‹é …')) {
                    // ç•™æ„äº‹é …ã®è©³ç´°
                    return {
                        text: `<strong>ğŸ”” ä¸Šç”°äºœå­£ã•ã‚“ã®ç•™æ„äº‹é …</strong><br><br>

<div style="background: #FEE2E2; border-left: 4px solid #DC2626; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
<strong>âš ï¸ ã„ã˜ã‚ãƒ»å¯¾äººé–¢ä¿‚</strong>ï¼ˆ2024/11/03 ç™»éŒ²ï¼‰<br><br>
å°å­¦æ ¡æ™‚ä»£ã„ã˜ã‚ã‚‰ã‚ŒãŸçµŒé¨“ã‚ã‚Šã€‚<br>
<strong>2çµ„é«˜æ©‹ã•ã‚“ã€3çµ„ä½è—¤ã•ã‚“ã¨ã®é–¢ã‚ã‚Šã¯æ³¨è¦–ã—ã¦ã»ã—ã„</strong>ã¨ãŠæ¯æ§˜ã‹ã‚‰ã”è¦æœ›ã€‚
</div>

<div style="background: #DBEAFE; border-left: 4px solid #3B82F6; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
<strong>ğŸ  å®¶åº­ç’°å¢ƒ</strong>ï¼ˆ2024/12/05 ç™»éŒ²ï¼‰<br><br>
ã”ä¸¡è¦ªãŒå…±åƒãã®ãŸã‚<strong>æ—¥ä¸­é€£çµ¡ãŒã¤ãã¥ã‚‰ã„</strong>ã“ã¨ãŒå¤šã„ã§ã™ã€‚<br>
é€£çµ¡ã¯ã¾ãªã³ãƒã‚±ãƒƒãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ©Ÿèƒ½ã‚„é€£çµ¡å¸³ã®æ´»ç”¨ã‚’æ¨å¥¨ã€‚
</div>

<strong>ğŸ¤ å…„å¼Ÿæƒ…å ±ï¼š</strong><br>
â€¢ 2å¹´2çµ„ <a href="#" style="color: #0066CC;">ä¸Šç”° å’Œæ¨¹</a>ï¼ˆå¼Ÿï¼‰<br>
â€¢ 4å¹´1çµ„ <a href="#" style="color: #0066CC;">ä¸Šç”° åŠ å¥ˆå­</a>ï¼ˆå¦¹ï¼‰<br><br>

<strong>ğŸ“‹ æ‰€å±ï¼š</strong><br>
â€¢ æ¤ç‰©ä¿‚<br>
â€¢ ãŠæ–™ç†ã‚¯ãƒ©ãƒ–ï¼ˆã‚­ãƒ£ãƒ—ãƒ†ãƒ³ï¼‰<br><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
</div>

<strong>ğŸ’¡ ãŠã™ã™ã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ“ ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’¬ å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦</button>
<button type="button" onclick="useSuggestion('ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¸ã®ç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ¥ SCç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ</button>
</div>`,
                        sources: ['ã¾ãªã³ãƒã‚±ãƒƒãƒˆç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'æ ¡å‹™ã‚·ã‚¹ãƒ†ãƒ ']
                    };
                } else if (lowerMessage.includes('ä¸Šç”°') || lowerMessage.includes('äºœå­£') || lowerMessage.includes('ç”Ÿå¾’')) {
                    // æ±ç”¨çš„ãªä¸Šç”°ã•ã‚“æ¤œç´¢
                    return {
                        text: `<strong>ğŸ‘©â€ğŸ“ ä¸Šç”° äºœå­£ã•ã‚“ï¼ˆ6å¹´1çµ„27ç•ªï¼‰</strong><br><br>

<div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
âš ï¸ <strong>æ³¨æ„ãŒå¿…è¦ãªçŠ¶æ³</strong><br>
ç›´è¿‘1é€±é–“ã€<span style="color: #DC2626; font-weight: 600;">æ—©é€€ã‚„é…åˆ»ãŒç¶šã„ã¦ãŠã‚Š</span>ã€å¿ƒã‚„ä½“ã®èª¿å­ãŒå°‘ã—æ°—ã«ãªã‚‹ã¨ã“ã‚ã§ã™ã€‚å¿ƒã®å¥åº·è¦³å¯Ÿã§ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ã¾ã™ã€‚
</div>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

è©³ã—ãç¢ºèªã—ãŸã„é …ç›®ã‚’é¸ã‚“ã§ãã ã•ã„ï¼š<br><br>

<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>`,
                        sources: ['ã¾ãªã³ãƒã‚±ãƒƒãƒˆç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'å¿ƒã®å¥åº·è¦³å¯Ÿ']
                    };
                } else if (lowerMessage.includes('å£°ã‹ã‘') && lowerMessage.includes('ä¸Šç”°')) {
                    return {
                        text: `<strong>ğŸ’¬ ä¸Šç”°äºœå­£ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹</strong><br><br>

<strong>ğŸŒ… æœã®å£°ã‹ã‘ï¼ˆç™»æ ¡æ™‚ï¼‰ï¼š</strong><br>
ã€ŒãŠã¯ã‚ˆã†ã€äºœå­£ã•ã‚“ã€‚ä»Šæ—¥ã‚‚æ¥ã¦ãã‚Œã¦ã†ã‚Œã—ã„ã‚ˆã€‚èª¿å­ã¯ã©ã†ï¼Ÿã€<br>
â†’ ç™»æ ¡ã§ããŸã“ã¨è‡ªä½“ã‚’è‚¯å®šçš„ã«å—ã‘æ­¢ã‚ã‚‹<br><br>

<strong>ğŸ“š æˆæ¥­ä¸­ï¼ˆç®—æ•°ã§å›°ã£ã¦ã„ã‚‹æ™‚ï¼‰ï¼š</strong><br>
ã€Œã“ã®å•é¡Œã€å›½èªã®èª­è§£åŠ›ã‚’ä½¿ã†ã¨è§£ãã‚„ã™ã„ã‚ˆã€‚äºœå­£ã•ã‚“ã¯æ–‡ç« ã‚’èª­ã¿å–ã‚‹åŠ›ãŒã™ã”ã„ã‹ã‚‰ã€å•é¡Œæ–‡ã‚’ã˜ã£ãã‚Šèª­ã‚“ã§ã¿ã¦ã€<br>
â†’ å¾—æ„åˆ†é‡ï¼ˆå›½èª97ç‚¹ï¼‰ã¨é–¢é€£ã¥ã‘ã¦è‡ªä¿¡ã‚’æŒãŸã›ã‚‹<br><br>

<strong>ğŸ˜´ æˆæ¥­ä¸­ã«çœ ãã†ãªæ™‚ï¼š</strong><br>
ã€Œäºœå­£ã•ã‚“ã€å°‘ã—ç–²ã‚Œã¦ã‚‹ï¼Ÿä¿å¥å®¤ã§ä¼‘ã‚€ï¼Ÿãã‚Œã¨ã‚‚é¡”æ´—ã£ã¦ãã‚‹ï¼Ÿã€<br>
â†’ è²¬ã‚ãšã«é¸æŠè‚¢ã‚’æç¤ºã€‚é…åˆ»ãƒ»æ—©é€€ãŒå¤šã„èƒŒæ™¯ã«é…æ…®<br><br>

<strong>ğŸ† è‰¯ã„è¡Œå‹•ã‚’è¦‹ã¤ã‘ãŸæ™‚ï¼š</strong><br>
ã€Œä½œæ–‡ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«å¤§è³ãŠã‚ã§ã¨ã†ï¼ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ã¨ã—ã¦ã‚‚é ‘å¼µã£ã¦ã‚‹ã­ã€‚å…ˆç”Ÿã€äºœå­£ã•ã‚“ã®é ‘å¼µã‚Šè¦‹ã¦ã‚‹ã‚ˆã€<br>
â†’ å…·ä½“çš„ãªæˆæœã‚’è¨€è‘‰ã«ã—ã¦æ‰¿èª<br><br>

<strong>ğŸ’š å¿ƒé…ãªæ§˜å­ã‚’æ„Ÿã˜ãŸæ™‚ï¼š</strong><br>
ã€Œæœ€è¿‘ã©ã†ï¼Ÿä½•ã‹æ°—ã«ãªã‚‹ã“ã¨ãŒã‚ã£ãŸã‚‰ã€ã„ã¤ã§ã‚‚è©±èãã‹ã‚‰ã­ã€‚æ”¾èª²å¾Œã§ã‚‚ã€é€£çµ¡å¸³ã§ã‚‚ã„ã„ã‚ˆã€<br>
â†’ ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆã«é…æ…®ã—ã€è©±ã—ã‚„ã™ã„é›°å›²æ°—ã‚’ä½œã‚‹<br><br>

<div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 12px; border-radius: 8px; margin-top: 16px;">
âš ï¸ <strong>æ³¨æ„ç‚¹</strong><br>
â€¢ å°å­¦æ ¡æ™‚ä»£ã®ã„ã˜ã‚çµŒé¨“ãŒã‚ã‚‹ãŸã‚ã€å‹äººé–¢ä¿‚ï¼ˆç‰¹ã«2çµ„é«˜æ©‹ã•ã‚“ã€3çµ„ä½è—¤ã•ã‚“ï¼‰ã«ã¯æ³¨æ„ã‚’æ‰•ã†<br>
â€¢ ã”ä¸¡è¦ªãŒå…±åƒãã§æ—¥ä¸­é€£çµ¡ãŒå–ã‚Šã¥ã‚‰ã„ãŸã‚ã€é€£çµ¡å¸³ã‚„ã‚¢ãƒ—ãƒªã§ã®é€£çµ¡ã‚’æ´»ç”¨
</div><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>

<strong>ğŸ’¡ ä»–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ“ ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ</button>
<button type="button" onclick="useSuggestion('ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¸ã®ç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ¥ SCç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ</button>
</div>`,
                        sources: ['ç”Ÿå¾’æŒ‡å°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³', 'ç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'å¿ƒã®å¥åº·è¦³å¯Ÿ']
                    };
                } else if (lowerMessage.includes('ä¿è­·è€…') && lowerMessage.includes('é€£çµ¡') && lowerMessage.includes('ä¸Šç”°')) {
                    return {
                        text: `<strong>ğŸ“ ä¸Šç”°äºœå­£ã•ã‚“ã®ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ï¼ˆæ¡ˆï¼‰</strong><br><br>

<div style="background: white; border: 1px solid #E5E7EB; border-radius: 8px; padding: 16px;">
<p style="margin-bottom: 8px;">ä¸Šç”°æ§˜</p>
<p style="margin-bottom: 8px;">ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚6å¹´1çµ„æ‹…ä»»ã®éˆ´æœ¨ã§ã™ã€‚</p>
<p style="margin-bottom: 8px;">äºœå­£ã•ã‚“ã®æœ€è¿‘ã®æ§˜å­ã«ã¤ã„ã¦ãŠä¼ãˆã—ãŸãã€ã”é€£çµ¡ã„ãŸã—ã¾ã—ãŸã€‚</p>
<p style="margin-bottom: 8px;">ã¾ãšå¬‰ã—ã„ã”å ±å‘Šã¨ã—ã¦ã€ä½œæ–‡ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«ã§å¤§è³ã‚’å—è³ã•ã‚Œã¾ã—ãŸã€‚ã¾ãŸã€å­¦ç¿’ã‚¢ãƒ—ãƒªã€Œãƒ‰ãƒªãƒ«ãƒ‘ãƒ¼ã‚¯ã€ã«ã‚‚ç†±å¿ƒã«å–ã‚Šçµ„ã‚“ã§ãŠã‚Šã€å­¦ã³ã¸ã®æ„æ¬²ãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚</p>
<p style="margin-bottom: 8px;">ä¸€æ–¹ã§ã€ã“ã“1é€±é–“ã»ã©é…åˆ»ã‚„æ—©é€€ãŒç¶šã„ã¦ãŠã‚Šã€å¿ƒã®å¥åº·è¦³å¯Ÿã§ã‚‚å°‘ã—æ°—ã«ãªã‚‹ã‚³ãƒ¡ãƒ³ãƒˆãŒè¦‹ã‚‰ã‚Œã¾ã—ãŸã€‚ä½“èª¿é¢ã‚„å­¦æ ¡ç”Ÿæ´»ã§ä½•ã‹ã”å¿ƒé…ãªã“ã¨ãŒã‚ã‚Œã°ã€ãœã²ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚</p>
<p style="margin-bottom: 8px;">ãŠå¿™ã—ã„ã¨ã“ã‚æã‚Œå…¥ã‚Šã¾ã™ãŒã€ãŠæ™‚é–“ã®ã‚ã‚‹æ™‚ã«ã”é€£çµ¡ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚é›»è©±ãŒé›£ã—ã„å ´åˆã¯ã€ã¾ãªã³ãƒã‚±ãƒƒãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ©Ÿèƒ½ã§ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚</p>
<p style="margin-bottom: 8px;">ä»Šå¾Œã¨ã‚‚äºœå­£ã•ã‚“ã®æˆé•·ã‚’ä¸€ç·’ã«è¦‹å®ˆã£ã¦ã„ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚</p>
<p>6å¹´1çµ„æ‹…ä»» éˆ´æœ¨</p>
</div><br>

<strong>ğŸ“‹ é€£çµ¡ã®ãƒã‚¤ãƒ³ãƒˆï¼š</strong><br>
â€¢ ãƒã‚¸ãƒ†ã‚£ãƒ–ãªå†…å®¹ï¼ˆä½œæ–‡å¤§è³ã€å­¦ç¿’æ„æ¬²ï¼‰ã‚’å…ˆã«ä¼ãˆã‚‹<br>
â€¢ å¿ƒé…äº‹ã¯å…·ä½“çš„ã«ä¼ãˆã¤ã¤ã€è²¬ã‚ã‚‹ãƒˆãƒ¼ãƒ³ã‚’é¿ã‘ã‚‹<br>
â€¢ ã”ä¸¡è¦ªãŒå…±åƒãã®ãŸã‚ã€è¤‡æ•°ã®é€£çµ¡æ‰‹æ®µã‚’æç¤º<br><br>

ã“ã®æ–‡é¢ã§ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿä¿®æ­£ç‚¹ãŒã‚ã‚Œã°ãŠä¼ãˆãã ã•ã„ã€‚`,
                        sources: ['ç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'ä¿è­·è€…é€£çµ¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ']
                    };
                } else if (lowerMessage.includes('ç®—æ•°') && lowerMessage.includes('æ”¯æ´') && lowerMessage.includes('ä¸Šç”°')) {
                    return {
                        text: `<strong>ğŸ“š ä¸Šç”°äºœå­£ã•ã‚“ã®ç®—æ•° å€‹åˆ¥æ”¯æ´è¨ˆç”»</strong><br><br>

<strong>ğŸ“Š ç¾çŠ¶åˆ†æï¼š</strong><br>
â€¢ å®šæœŸãƒ†ã‚¹ãƒˆï¼š67ç‚¹ï¼ˆã‚¯ãƒ©ã‚¹å¹³å‡ã‚ˆã‚Šä¸‹ï¼‰<br>
â€¢ å˜å…ƒãƒ†ã‚¹ãƒˆæ¨ç§»ï¼šåˆ†æ•°ã®å‰²ã‚Šç®—ã§æˆç¸¾ãŒä¸‹ãŒã£ã¦ã„ã‚‹<br>
â€¢ æˆæ¥­ä¸­ã®æ§˜å­ï¼šçœ ãã†ã«ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹<br>
â€¢ å¼·ã¿ï¼šå›½èª97ç‚¹ã€èª­è§£åŠ›ãŒé«˜ã„<br><br>

<strong>ğŸ¯ æ”¯æ´æ–¹é‡ï¼š</strong><br>
<div style="background: #EBF5FF; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
<strong>èª­è§£åŠ›ã‚’æ´»ã‹ã—ãŸç®—æ•°æŒ‡å°</strong><br>
æ–‡ç« é¡Œã‚’ä¸­å¿ƒã«ã€å¾—æ„ãªå›½èªåŠ›ã‚’ç®—æ•°ã«æ©‹æ¸¡ã—ã™ã‚‹
</div>

<strong>ğŸ“ å…·ä½“çš„ãªæ”¯æ´å†…å®¹ï¼š</strong><br><br>

<strong>1. æˆæ¥­ä¸­ã®é…æ…®</strong><br>
â€¢ åº§å¸­ã‚’å‰æ–¹ã«é…ç½®ã—ã€é›†ä¸­ã—ã‚„ã™ã„ç’°å¢ƒã‚’æ•´ãˆã‚‹<br>
â€¢ æ–‡ç« é¡Œã§ã¯ã€Œã¾ãšå•é¡Œæ–‡ã‚’å£°ã«å‡ºã—ã¦èª­ã‚“ã§ã¿ã‚ˆã†ã€ã¨ä¿ƒã™<br>
â€¢ çœ ãã†ãªæ™‚ã¯è²¬ã‚ãšã«ã€è»½ã„ä¼‘æ†©ã‚„æ°´åˆ†è£œçµ¦ã‚’è¨±å¯<br><br>

<strong>2. å€‹åˆ¥èª²é¡Œã®è¨­å®š</strong><br>
â€¢ ãƒ‰ãƒªãƒ«ãƒ‘ãƒ¼ã‚¯ã€Œç®—æ•°/æ•°å­¦ã€åŸºæœ¬ãƒ¬ãƒ™ãƒ«ã‹ã‚‰æ®µéšçš„ã«<br>
â€¢ åˆ†æ•°ã®è¨ˆç®—ã¯è¦–è¦šçš„ãªå›³è§£ã‚’å¤šç”¨<br>
â€¢ 1æ—¥10åˆ†ç¨‹åº¦ã®çŸ­æ™‚é–“é›†ä¸­å‹<br><br>

<strong>3. æˆåŠŸä½“é¨“ã®ç©ã¿é‡ã­</strong><br>
â€¢ å°ã•ãªé€²æ­©ã‚‚å…·ä½“çš„ã«è¤’ã‚ã‚‹<br>
â€¢ ã€Œå‰å›ã‚ˆã‚Šè§£ã‘ã‚‹ã‚ˆã†ã«ãªã£ãŸã­ã€ã¨æ¯”è¼ƒã§æˆé•·ã‚’å®Ÿæ„Ÿã•ã›ã‚‹<br>
â€¢ ã‚¯ãƒ©ã‚¹ãƒ¡ã‚¤ãƒˆã¨ã®æ•™ãˆåˆã„å­¦ç¿’ã§ã‚­ãƒ£ãƒ—ãƒ†ãƒ³çµŒé¨“ã‚’æ´»ã‹ã™<br><br>

<strong>ğŸ“… æŒ¯ã‚Šè¿”ã‚Šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼š</strong><br>
â€¢ 2é€±é–“å¾Œï¼šå˜å…ƒãƒ†ã‚¹ãƒˆã®çµæœç¢ºèª<br>
â€¢ 1ãƒ¶æœˆå¾Œï¼šæ”¯æ´è¨ˆç”»ã®è¦‹ç›´ã—<br><br>

ã“ã®è¨ˆç”»ã‚’åŸºã«é€²ã‚ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`,
                        sources: ['ç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'å˜å…ƒãƒ†ã‚¹ãƒˆçµæœ', 'ãƒ‰ãƒªãƒ«ãƒ‘ãƒ¼ã‚¯å­¦ç¿’å±¥æ­´', 'å€‹åˆ¥æ”¯æ´è¨ˆç”»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ']
                    };
                } else if (lowerMessage.includes('å¿ƒã®å¥åº·') && lowerMessage.includes('ä¸Šç”°')) {
                    return {
                        text: `<strong>ğŸ’š ä¸Šç”°äºœå­£ã•ã‚“ã®å¿ƒã®å¥åº·è¦³å¯Ÿ æ¨ç§»</strong><br><br>

<div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
âš ï¸ <strong>ç›´è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆ</strong><br>
ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãŠã‚Šã€å¿ƒã®å¥åº·è¦³å¯Ÿã§3ä»¥ä¸Šã®å›ç­”ãŒå¤šãè¦‹ã‚‰ã‚Œã¾ã™ã€‚
</div>

<strong>ğŸ“ˆ ä»Šå¹´åº¦ã®å‚¾å‘ï¼š</strong><br>
â€¢ å¿ƒã®å¥åº·è¦³å¯Ÿã§ã¯3ä»¥ä¸Šã®å›ç­”ãŒå¤šã„<br>
â€¢ æ¬ å¸­æ•°ã‚‚å­¦å¹´å¹³å‡ã‚ˆã‚Š1.8å›/æœˆå°‘ãªã„ãŸã‚ã€åŸºæœ¬çš„ã«ã¯å¤§ããªå•é¡Œãªãå­¦æ ¡ã«é€šã£ã¦ã„ã‚‹<br>
â€¢ ãŸã ã—ã€ä¿å¥å®¤åˆ©ç”¨çŠ¶æ³ã§ã¯3æœˆã«è¤‡æ•°å›åˆ©ç”¨ã—ã¦ãŠã‚Šã€èº«ä½“çš„ãƒ»å¿ƒç†çš„ãªä¸èª¿ãŒè¦‹ã‚‰ã‚Œã‚‹<br><br>

<strong>ğŸ“Š ç›´è¿‘1é€±é–“ã®å¤‰åŒ–ï¼š</strong><br>
â€¢ æ—©é€€ãƒ»é…åˆ»ãŒç¶šã„ã¦ã„ã‚‹<br>
â€¢ ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã„ã†ã‚³ãƒ¡ãƒ³ãƒˆ<br>
â€¢ ä¿å¥å®¤æ¥å®¤ã‚ã‚Š<br><br>

<strong>ğŸ” è€ƒãˆã‚‰ã‚Œã‚‹èƒŒæ™¯ï¼š</strong><br>
â€¢ å°å­¦æ ¡æ™‚ä»£ã®ã„ã˜ã‚çµŒé¨“ã®å½±éŸ¿<br>
â€¢ ç‰¹å®šã®ç”Ÿå¾’ï¼ˆ2çµ„é«˜æ©‹ã•ã‚“ã€3çµ„ä½è—¤ã•ã‚“ï¼‰ã¨ã®é–¢ä¿‚<br>
â€¢ ç®—æ•°ã¸ã®è‹¦æ‰‹æ„è­˜ã«ã‚ˆã‚‹è‡ªå·±è‚¯å®šæ„Ÿã®ä½ä¸‹<br>
â€¢ å®¶åº­ç’°å¢ƒï¼ˆã”ä¸¡è¦ªå…±åƒãã§æ—¥ä¸­é€£çµ¡ãŒã¤ãã¥ã‚‰ã„ï¼‰<br><br>

<strong>ğŸ’¡ æ¨å¥¨å¯¾å¿œï¼š</strong><br>
1. æœ¬äººã¨ã®å€‹åˆ¥é¢è«‡ï¼ˆæ”¾èª²å¾Œãªã©è½ã¡ç€ã„ãŸç’°å¢ƒã§ï¼‰<br>
2. äº¤å‹é–¢ä¿‚ã®è¦³å¯Ÿï¼ˆç‰¹ã«ä¼‘ã¿æ™‚é–“ã€çµ¦é£Ÿæ™‚é–“ï¼‰<br>
3. ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¨ã®é€£æºæ¤œè¨<br>
4. ä¿è­·è€…ã¸ã®çŠ¶æ³å…±æœ‰<br><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>

<strong>ğŸ’¡ ãŠã™ã™ã‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã¸ã®ç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ¥ SCç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆ</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ“ ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’¬ å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦</button>
</div>`,
                        sources: ['å¿ƒã®å¥åº·è¦³å¯Ÿ', 'ç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'ä¿å¥å®¤åˆ©ç”¨çŠ¶æ³']
                    };
                } else if (lowerMessage.includes('ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼') || lowerMessage.includes('SC') && lowerMessage.includes('ç›¸è«‡')) {
                    return {
                        text: `<strong>ğŸ¥ ã‚¹ã‚¯ãƒ¼ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ç›¸è«‡ãƒ¡ãƒ¢</strong><br><br>

<div style="background: white; border: 1px solid #E5E7EB; border-radius: 8px; padding: 16px;">
<strong>ç›¸è«‡å¯¾è±¡ï¼š</strong>ä¸Šç”° äºœå­£ï¼ˆ6å¹´1çµ„27ç•ªï¼‰<br>
<strong>ç›¸è«‡æ—¥ï¼š</strong>____å¹´__æœˆ__æ—¥<br>
<strong>æ‹…ä»»ï¼š</strong>éˆ´æœ¨<br><br>

<strong>ã€ç›¸è«‡ç†ç”±ã€‘</strong><br>
ç›´è¿‘1é€±é–“ã§æ—©é€€ãƒ»é…åˆ»ãŒç¶šã„ã¦ãŠã‚Šã€å¿ƒã®å¥åº·è¦³å¯Ÿã§ã€Œå­¦æ ¡ãŒæ¥½ã—ããªã„ã€ã¨ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚ã‚Šã€‚æœ¬äººã®å¿ƒç†çŠ¶æ…‹ã«ã¤ã„ã¦å°‚é–€çš„ãªè¦–ç‚¹ã‹ã‚‰ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ã„ãŸã ããŸã„ã€‚<br><br>

<strong>ã€ç”Ÿå¾’ã®åŸºæœ¬æƒ…å ±ã€‘</strong><br>
â€¢ å­¦æ¥­æˆç¸¾ï¼šå›½èªãƒ»ç†ç§‘ãƒ»ç¤¾ä¼šã¯å„ªç§€ï¼ˆ90ç‚¹å°ï¼‰ã€ç®—æ•°ã¯è‹¦æ‰‹ï¼ˆ67ç‚¹ï¼‰<br>
â€¢ éƒ¨æ´»å‹•ï¼šæ–™ç†ã‚¯ãƒ©ãƒ– ã‚­ãƒ£ãƒ—ãƒ†ãƒ³<br>
â€¢ æœ€è¿‘ã®è¡¨å½°ï¼šä½œæ–‡ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«å¤§è³<br>
â€¢ å…„å¼Ÿï¼šå¼Ÿï¼ˆ2å¹´2çµ„ï¼‰ã€å¦¹ï¼ˆ4å¹´1çµ„ï¼‰<br><br>

<strong>ã€æ°—ã«ãªã‚‹ç‚¹ã€‘</strong><br>
â€¢ å°å­¦æ ¡æ™‚ä»£ã«ã„ã˜ã‚ã‚‰ã‚ŒãŸçµŒé¨“ã‚ã‚Š<br>
â€¢ ãŠæ¯æ§˜ã‚ˆã‚Šã€2çµ„é«˜æ©‹ã•ã‚“ãƒ»3çµ„ä½è—¤ã•ã‚“ã¨ã®é–¢ã‚ã‚Šã‚’æ³¨è¦–ã—ã¦ã»ã—ã„ã¨ã®ã”è¦æœ›<br>
â€¢ ç®—æ•°ã®æˆæ¥­ä¸­ã«çœ ãã†ã«ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚‹<br>
â€¢ ä¿å¥å®¤ã‚’3æœˆã«è¤‡æ•°å›åˆ©ç”¨<br>
â€¢ ã”ä¸¡è¦ªãŒå…±åƒãã§æ—¥ä¸­ã®é€£çµ¡ãŒå–ã‚Šã¥ã‚‰ã„<br><br>

<strong>ã€æ‹…ä»»ã¨ã—ã¦å®Ÿæ–½ã—ãŸã“ã¨ã€‘</strong><br>
â€¢ æœã®å£°ã‹ã‘ã‚’æ„è­˜çš„ã«å®Ÿæ–½<br>
â€¢ ç®—æ•°ã®å€‹åˆ¥æ”¯æ´ã‚’æ¤œè¨ä¸­<br>
â€¢ ä¿è­·è€…ã¸ã®é€£çµ¡ã‚’äºˆå®š<br><br>

<strong>ã€ã”ç›¸è«‡ã—ãŸã„ã“ã¨ã€‘</strong><br>
1. æœ¬äººã¨ã®é¢è«‡ã®é€²ã‚æ–¹<br>
2. ã„ã˜ã‚çµŒé¨“ã®ã‚ã‚‹ç”Ÿå¾’ã¸ã®é…æ…®äº‹é …<br>
3. ä¿è­·è€…ã¨ã®é€£æºæ–¹æ³•<br>
4. ã‚¯ãƒ©ã‚¹å†…ã§ã®è¦‹å®ˆã‚Šä½“åˆ¶
</div><br>

<div style="margin-bottom: 16px;">
<button type="button" onclick="openKarteModal()" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #0066CC; color: white; border-radius: 8px; border: none; font-size: 13px; font-weight: 600; cursor: pointer;">
ğŸ“‚ ç”Ÿå¾’ã‚«ãƒ«ãƒ†ã‚’é–‹ãï¼ˆã¾ãªã³ãƒã‚±ãƒƒãƒˆï¼‰
</button>
</div>

<hr style="border: none; border-top: 1px solid #E5E7EB; margin: 16px 0;">

<strong>ğŸ“‚ ä»–ã®æƒ…å ±ã‚‚ç¢ºèªã™ã‚‹ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦æ ¡ç”Ÿæ´»çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ« å­¦æ ¡ç”Ÿæ´»çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®å­¦ç¿’çŠ¶æ³ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ“š å­¦ç¿’çŠ¶æ³</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ç•™æ„äº‹é …ã‚’è©³ã—ã')" style="padding: 10px 20px; background: white; border: 2px solid #0066CC; border-radius: 8px; color: #0066CC; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#EBF5FF'" onmouseout="this.style.background='white'">ğŸ”” ç•™æ„äº‹é …</button>
</div>

<strong>ğŸ’¡ ä»–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br><br>
<div style="display: flex; flex-wrap: wrap; gap: 8px;">
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã®ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ“ ä¿è­·è€…ã¸ã®é€£çµ¡æ–‡ã‚’ä½œæˆ</button>
<button type="button" onclick="useSuggestion('ä¸Šç”°ã•ã‚“ã¸ã®å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦')" style="padding: 8px 16px; background: #EBF5FF; border: 1px solid #0066CC; border-radius: 20px; color: #0066CC; font-size: 13px; cursor: pointer;">ğŸ’¬ å£°ã‹ã‘ä¾‹ã‚’æ•™ãˆã¦</button>
</div><br>

ã“ã®å†…å®¹ã§ç›¸è«‡ãƒ¡ãƒ¢ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ä¿®æ­£ã‚„è¿½åŠ ãŒã‚ã‚Œã°ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚`,
                        sources: ['ç”Ÿå¾’ã‚«ãƒ«ãƒ†', 'SCç›¸è«‡ãƒ¡ãƒ¢ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ']
                    };
                } else if (lowerMessage.includes('ä¿è­·è€…') || lowerMessage.includes('è³‡æ–™')) {
                    return {
                        text: `<strong>ä¿è­·è€…ä¼šã®è³‡æ–™ä½œæˆ</strong><br><br>
ä¿è­·è€…ä¼šã®è³‡æ–™ä½œæˆã‚’ãŠæ‰‹ä¼ã„ã—ã¾ã™ã€‚ä»¥ä¸‹ã®å†…å®¹ã‚’ãƒ™ãƒ¼ã‚¹ã«ä½œæˆã—ã¾ã™ã‹ï¼Ÿ<br><br>

<strong>ğŸ“‹ æ¨å¥¨æ§‹æˆï¼š</strong><br>
1. <strong>å­¦ç´šã®æ§˜å­</strong>ï¼ˆ5åˆ†ï¼‰<br>
   â€¢ å…¨ä½“ã®é›°å›²æ°—ã¨æˆé•·<br>
   â€¢ æœ€è¿‘ã®å–ã‚Šçµ„ã¿<br><br>

2. <strong>å­¦ç¿’çŠ¶æ³</strong>ï¼ˆ10åˆ†ï¼‰<br>
   â€¢ å„æ•™ç§‘ã®é€²æ—<br>
   â€¢ ãƒ†ã‚¹ãƒˆçµæœã®å‚¾å‘<br>
   â€¢ å€‹åˆ¥æ”¯æ´ã®å–ã‚Šçµ„ã¿<br><br>

3. <strong>å­¦æ ¡è¡Œäº‹ãƒ»ä»Šå¾Œã®äºˆå®š</strong>ï¼ˆ5åˆ†ï¼‰<br>
   â€¢ ä¿®å­¦æ—…è¡Œã®æº–å‚™çŠ¶æ³<br>
   â€¢ é€²è·¯èª¬æ˜ä¼šã®æ—¥ç¨‹<br><br>

4. <strong>ãŠé¡˜ã„ã¨Q&A</strong>ï¼ˆ10åˆ†ï¼‰<br>
   â€¢ å®¶åº­ã§ã®å”åŠ›äº‹é …<br>
   â€¢ è³ªç–‘å¿œç­”<br><br>

å…·ä½“çš„ãªå†…å®¹ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿãã‚Œã¨ã‚‚ç‰¹å®šã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ`,
                        sources: ['å­¦ç´šçµŒå–¶ãƒ‡ãƒ¼ã‚¿', 'å¹´é–“è¨ˆç”»']
                    };
                }
            }
            
            if (lowerMessage.includes('å°å…¥')) {
                return {
                    text: `<strong>3å¹´2çµ„ã®äºŒæ¬¡é–¢æ•°ã®å¿œç”¨ - å°å…¥æ¡ˆ</strong><br><br>

<strong>ğŸ“º ãŠã™ã™ã‚ï¼šå¤§è°·ç¿”å¹³ã®æœ€æ–°ãƒ›ãƒ¼ãƒ ãƒ©ãƒ³åˆ†æ</strong><br><br>

æ˜¨æ—¥ã®è©¦åˆã§å¤§è°·é¸æ‰‹ãŒæ‰“ã£ãŸ140mè¶…ãˆã®ãƒ›ãƒ¼ãƒ ãƒ©ãƒ³ã€‚ãã®ç¾ã—ã„æ”¾ç‰©ç·šã‚’äºŒæ¬¡é–¢æ•°ã§åˆ†æã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br><br>

<strong>å°å…¥ã®æµã‚Œï¼ˆ5åˆ†ï¼‰ï¼š</strong><br>
1. å‹•ç”»ã‚’è¦‹ã›ã‚‹ï¼ˆ1åˆ†ï¼‰<br>
2. ã€Œã“ã®è»Œé“ã€æ•°å¼ã§è¡¨ã›ã‚‹ã¨æ€ã†ï¼Ÿã€ã¨å•ã„ã‹ã‘<br>
3. å‰å›å­¦ã‚“ã  y = a(x-p)Â² + q ã®å¾©ç¿’<br>
4. ã€Œä»Šæ—¥ã¯ã“ã®å¼ã‚’ä½¿ã£ã¦ã€å®Ÿéš›ã®è»Œé“ã‚’è¨ˆç®—ã—ã¦ã¿ã‚ˆã†ã€<br><br>

<strong>ã‚¯ãƒ©ã‚¹ç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸå·¥å¤«ï¼š</strong><br>
ã“ã®ã‚¯ãƒ©ã‚¹ã¯é‡çƒå¥½ããŒå¤šãï¼ˆ23åãŒè¨€åŠï¼‰ã€è¦–è¦šçš„ãªå°å…¥ã«åå¿œãŒè‰¯ã„å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚å‰å›ã®æº€è¶³åº¦ãŒ3.1ã¨ä½ã‚ã ã£ãŸãŸã‚ã€èˆˆå‘³å–šèµ·ã‚’é‡è¦–ã—ãŸå°å…¥ãŒãŠã™ã™ã‚ã§ã™ã€‚`,
                    sources: ['å‰å›æˆæ¥­ãƒ‡ãƒ¼ã‚¿', 'ã‚¹ãƒãƒ¼ãƒ„ãƒ‹ãƒ¥ãƒ¼ã‚¹', 'å˜å…ƒæƒ…å ±']
                };
            } else if (lowerMessage.includes('ç™ºå•')) {
                return {
                    text: `<strong>äºŒæ¬¡é–¢æ•°ã®å¿œç”¨ - åŠ¹æœçš„ãªç™ºå•æ¡ˆ3ã¤</strong><br><br>

<strong>ç™ºå•1ï¼šèˆˆå‘³å–šèµ·ï¼ˆå°å…¥æ™‚ï¼‰</strong><br>
ã€Œãƒã‚¹ã‚±ã®ã‚·ãƒ¥ãƒ¼ãƒˆã€ã‚µãƒƒã‚«ãƒ¼ã®FKã€å™´æ°´ã®æ°´ã€‚ã“ã‚Œå…¨éƒ¨ã€åŒã˜æ•°å­¦ã§èª¬æ˜ã§ãã‚‹ã£ã¦çŸ¥ã£ã¦ãŸï¼Ÿã€<br>
â†’ èº«è¿‘ãªç¾è±¡ã¨æ•°å­¦ã®ç¹‹ãŒã‚Šã‚’æ„è­˜ã•ã›ã‚‹<br><br>

<strong>ç™ºå•2ï¼šç†è§£ç¢ºèªï¼ˆå±•é–‹æ™‚ï¼‰</strong><br>
ã€Œã“ã®å¼ y = -2(x-3)Â² + 8 ã‚’è¦‹ã¦ã€é ‚ç‚¹ã®åº§æ¨™ã‚’ç­”ãˆã‚‰ã‚Œã‚‹äººï¼Ÿéš£ã®äººã¨ç¢ºèªã—ã¦ã¿ã¦ã€<br>
â†’ ãƒšã‚¢ã§ç¢ºèªã™ã‚‹ã“ã¨ã§åŸºç¤å±¤ã‚‚å®‰å¿ƒã—ã¦å‚åŠ ã§ãã‚‹<br><br>

<strong>ç™ºå•3ï¼šæ€è€ƒæ·±åŒ–ï¼ˆã¾ã¨ã‚æ™‚ï¼‰</strong><br>
ã€Œã‚‚ã— a ã®å€¤ã‚’å¤‰ãˆãŸã‚‰ã€ã‚°ãƒ©ãƒ•ã¯ã©ã†å¤‰ã‚ã‚‹ï¼Ÿäºˆæƒ³ã—ã¦ã‹ã‚‰å®Ÿéš›ã«ç¢ºã‹ã‚ã¦ã¿ã‚ˆã†ã€<br>
â†’ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ„å‘³ã¸ã®æ°—ã¥ãã‚’ä¿ƒã™`,
                    sources: ['å‰å›æˆæ¥­ãƒ‡ãƒ¼ã‚¿', 'å˜å…ƒæƒ…å ±', 'ç™ºå•ç†è«–']
                };
            } else if (lowerMessage.includes('å®¿é¡Œ') || lowerMessage.includes('ãƒ¬ãƒ™ãƒ«åˆ¥')) {
                return {
                    text: `<strong>ç†è§£ãƒ¬ãƒ™ãƒ«åˆ¥ã®å®¿é¡Œè¨­å®š - 3å¹´2çµ„</strong><br><br>

<strong>ğŸŒ± åŸºç¤å±¤ï¼ˆ8åï¼‰- ãƒ‰ãƒªãƒ«Xp P42-43</strong><br>
â€¢ å•é¡Œæ•°ï¼š15å•ï¼ˆåŸºæœ¬è¨ˆç®—ä¸­å¿ƒï¼‰<br>
â€¢ æƒ³å®šæ™‚é–“ï¼š20åˆ†<br><br>

<strong>ğŸ“š æ¨™æº–å±¤ï¼ˆ24åï¼‰- ãƒ‰ãƒªãƒ«Xp P44-46</strong><br>
â€¢ å•é¡Œæ•°ï¼š20å•ï¼ˆã‚°ãƒ©ãƒ•èª­ã¿å–ã‚Šå«ã‚€ï¼‰<br>
â€¢ æƒ³å®šæ™‚é–“ï¼š25åˆ†<br><br>

<strong>ğŸš€ ç™ºå±•å±¤ï¼ˆ8åï¼‰- ãƒ‰ãƒªãƒ«Xp P47-48 + å¿œç”¨å•é¡Œ</strong><br>
â€¢ å•é¡Œæ•°ï¼š12å•ï¼ˆå¿œç”¨ãƒ»èåˆå•é¡Œï¼‰<br>
â€¢ æƒ³å®šæ™‚é–“ï¼š30åˆ†`,
                    sources: ['ç”Ÿå¾’ç†è§£åº¦ãƒ‡ãƒ¼ã‚¿', 'ãƒ‰ãƒªãƒ«Xpæ•™æ', 'å€‹åˆ¥å­¦ç¿’å±¥æ­´']
                };
            } else if (lowerMessage.includes('æ§˜å­') || lowerMessage.includes('çŠ¶æ³')) {
                return {
                    text: `<strong>3å¹´2çµ„ã®æœ€è¿‘ã®æ§˜å­ï¼ˆç›´è¿‘3å›ã®æˆæ¥­ã‹ã‚‰ï¼‰</strong><br><br>

<strong>ğŸ“Š å…¨ä½“å‚¾å‘ï¼š</strong><br>
â€¢ ç†è§£åº¦ï¼š2.9 â†’ 3.0 â†’ 3.3ï¼ˆæ”¹å–„å‚¾å‘ âœ…ï¼‰<br>
â€¢ æº€è¶³åº¦ï¼š3.8 â†’ 3.5 â†’ 3.1ï¼ˆä½ä¸‹å‚¾å‘ âš ï¸ï¼‰<br><br>

<strong>ğŸ’¬ ç”Ÿå¾’ã®å£°ã‹ã‚‰ï¼š</strong><br>
â€¢ ãƒã‚¸ãƒ†ã‚£ãƒ–ï¼šã€Œå‹é”ã¨å”åŠ›ã—ã¦è§£ã‘ãŸã€ã€Œãªã‚‹ã»ã©ã¨æ€ãˆãŸã€<br>
â€¢ ãƒã‚¬ãƒ†ã‚£ãƒ–ï¼šã€Œé›£ã—ã‹ã£ãŸã€ï¼ˆ18å›ï¼‰ã€ã€Œã‚ã‹ã‚‰ãªã„ã€ï¼ˆ15å›ï¼‰`,
                    sources: ['æŒ¯ã‚Šè¿”ã‚Šãƒ‡ãƒ¼ã‚¿(3å›åˆ†)', 'ã‚³ãƒ¡ãƒ³ãƒˆåˆ†æ', 'å€‹åˆ¥ç”Ÿå¾’æƒ…å ±']
                };
            } else if (lowerMessage.includes('å”åƒ') || lowerMessage.includes('ã‚°ãƒ«ãƒ¼ãƒ—')) {
                return {
                    text: `<strong>å”åƒå­¦ç¿’ã®è¨­è¨ˆæ¡ˆ - 3å¹´2çµ„å‘ã‘</strong><br><br>

<strong>ğŸ¯ æ´»å‹•å†…å®¹ï¼šã€Œæ”¾ç‰©ç·šãƒãƒ£ãƒ¬ãƒ³ã‚¸ - æœ€é©ãªè»Œé“ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€</strong><br><br>

<strong>ã‚°ãƒ«ãƒ¼ãƒ—ç·¨æˆï¼ˆ4äººÃ—9ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ï¼š</strong><br>
åŸºç¤å±¤1å + æ¨™æº–å±¤2å + ç™ºå±•å±¤1åã®æ··åˆç·¨æˆ<br>
â†’ æ•™ãˆåˆã„ãŒè‡ªç„¶ã«ç™ºç”Ÿã—ã‚„ã™ã„æ§‹æˆ<br><br>

<strong>æ´»å‹•ã®æµã‚Œï¼ˆ20åˆ†ï¼‰ï¼š</strong><br>
1. èª²é¡Œæç¤ºï¼ˆ2åˆ†ï¼‰<br>
2. ã‚°ãƒ«ãƒ¼ãƒ—è¨è­°ï¼ˆ12åˆ†ï¼‰<br>
3. å…¨ä½“å…±æœ‰ï¼ˆ6åˆ†ï¼‰`,
                    sources: ['ã‚¯ãƒ©ã‚¹ç‰¹æ€§åˆ†æ', 'å”åƒå­¦ç¿’ç†è«–', 'å‰å›æˆæ¥­ã®åå¿œ']
                };
            } else {
                return {
                    text: `ç†è§£ã—ã¾ã—ãŸã€‚ã€Œ${message}ã€ã«ã¤ã„ã¦ãŠç­”ãˆã—ã¾ã™ã€‚<br><br>

ã‚ˆã‚Šå…·ä½“çš„ãªè³ªå•ã‚’ã„ãŸã ã‘ã‚Œã°ã€è©³ã—ããŠç­”ãˆã§ãã¾ã™ã€‚`,
                    sources: ['ã‚¯ãƒ©ã‚¹ãƒ‡ãƒ¼ã‚¿', 'å˜å…ƒæƒ…å ±']
                };
            }
        }
        
        function loadHistory(title) {
            if (title === 'ä¸Šç”°äºœå­£ã•ã‚“') {
                // ä¸Šç”°äºœå­£ã•ã‚“ã®å±¥æ­´ã‚’èª­ã¿è¾¼ã‚“ã§ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹
                currentProject = null;
                currentContext = null;
                
                chatActive = true;
                document.getElementById('welcomeScreen').style.display = 'none';
                document.getElementById('messagesArea').innerHTML = '';
                document.getElementById('messageInput').value = '';
                
                updateHeader();
                updateQuickPrompts();
                
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
                addMessage('user', 'ä¸Šç”°äºœå­£ã•ã‚“ã®æœ€è¿‘ã®æ§˜å­ã‚’æ•™ãˆã¦');
                
                // AIã®å¿œç­”ã‚’ç”Ÿæˆ
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    const response = generateResponse('ä¸Šç”°äºœå­£ã•ã‚“ã®æœ€è¿‘ã®æ§˜å­');
                    addMessage('assistant', response.text, response.sources);
                }, 1000);
            } else {
                showSnackbar(`ã€Œ${title}ã€ã®å±¥æ­´ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãŸã‚æœªå®Ÿè£…ï¼‰`, 'ğŸ“', 3000);
            }
        }
        
        // ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰é€£æºãƒ¢ãƒƒã‚¯ - ã‚¢ã‚¤ãƒ†ãƒ ã‚’é–‹ã
        function openKnowledgeItem(fileName) {
            // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
            const modal = document.getElementById('sharepointModal');
            const fileNameElement = document.getElementById('sharepointFileName');
            
            fileNameElement.textContent = fileName;
            modal.classList.add('active');
            
            // èƒŒæ™¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã
            document.body.style.overflow = 'hidden';
        }
        
        function closeSharePointModal() {
            const modal = document.getElementById('sharepointModal');
            modal.classList.remove('active');
            
            // èƒŒæ™¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å¾©å…ƒ
            document.body.style.overflow = '';
        }
        
        function downloadFile() {
            showSnackbar('æŒ‡å°æ¡ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãŸã‚æœªå®Ÿè£…ï¼‰<br><br>å®Ÿéš›ã®ç’°å¢ƒã§ã¯ã€.docxãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚', 'ğŸ’¾', 3000);
        }
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('sharepointModal');
            if (e.target === modal) {
                closeSharePointModal();
            }
            // ç”Ÿå¾’ã‚«ãƒ«ãƒ†ãƒ¢ãƒ¼ãƒ€ãƒ«
            const karteModal = document.getElementById('karteModal');
            if (e.target === karteModal) {
                closeKarteModal();
            }
        });
        
        // ESCã‚­ãƒ¼ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('sharepointModal');
                if (modal.classList.contains('active')) {
                    closeSharePointModal();
                }
                const karteModal = document.getElementById('karteModal');
                if (karteModal.classList.contains('active')) {
                    closeKarteModal();
                }
            }
        });
        
        // ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰é€£æºãƒ¢ãƒƒã‚¯ - æ¥ç¶šãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
        function openDataSettings() {
            showSnackbar(`æ¥ç¶šãƒ‡ãƒ¼ã‚¿ç®¡ç†ç”»é¢ã‚’é–‹ãã¾ã™<br><br><strong>ã€ç¾åœ¨æ¥ç¶šä¸­ã€‘</strong><br>âœ… æ™‚é–“å‰²ãƒ‡ãƒ¼ã‚¿<br>âœ… å˜å…ƒæƒ…å ±<br>âœ… æˆæ¥­æŒ¯ã‚Šè¿”ã‚Šãƒ‡ãƒ¼ã‚¿<br>âœ… å¤§é˜ªå¸‚ãƒŠãƒ¬ãƒƒã‚¸å…±æœ‰ï¼ˆSharePointï¼‰<br>âœ… æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»æ•™è‚²ãƒˆãƒ¬ãƒ³ãƒ‰<br><br><strong>ã€æ¥ç¶šå¯èƒ½ã€‘</strong><br>âšª NHK for School API<br>âšª æ°‘é–“æ•™æAPI<br>âšª å¿ƒã®å¥åº·è¦³å¯Ÿãƒ‡ãƒ¼ã‚¿<br><br>ï¼ˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ãŸã‚æœªå®Ÿè£…ï¼‰`, 'âš™ï¸', 6000);
        }
        
        // ãƒªã‚µã‚¤ã‚ºæ©Ÿèƒ½
        let isResizing = false;
        let currentResizeTarget = null;
        
        document.getElementById('scheduleResizeHandle')?.addEventListener('mousedown', function(e) {
            isResizing = true;
            currentResizeTarget = document.getElementById('scheduleSection');
            document.body.style.cursor = 'ns-resize';
            document.body.style.userSelect = 'none';
        });
        
        document.addEventListener('mousemove', function(e) {
            if (!isResizing || !currentResizeTarget) return;
            
            const rect = currentResizeTarget.getBoundingClientRect();
            const newHeight = e.clientY - rect.top;
            
            if (newHeight >= 150 && newHeight <= 500) {
                currentResizeTarget.style.height = newHeight + 'px';
                currentResizeTarget.style.maxHeight = newHeight + 'px';
            }
        });
        
        document.addEventListener('mouseup', function() {
            if (isResizing) {
                isResizing = false;
                currentResizeTarget = null;
                document.body.style.cursor = '';
                document.body.style.userSelect = '';
            }
        });
    </script>
</body>
</html>
